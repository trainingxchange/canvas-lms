(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};define(["Backbone","underscore","i18n!overrides","compiled/models/AssignmentOverride","compiled/models/Section"],function(i,s,n,r,o){var u,a;return a=i.Model,u=function(){function i(t,i,s){var n,u,a;this.overrides=t,this.sections=i,this.assignment=s,this.toJSON=e(this.toJSON,this),this.sectionsWithoutOverrides=e(this.sectionsWithoutOverrides,this),this.sectionsWithOverrides=e(this.sectionsWithOverrides,this),this.blankOverrides=e(this.blankOverrides,this),this.containsBlankOverrides=e(this.containsBlankOverrides,this),this.sectionIDs=e(this.sectionIDs,this),this.containsSectionsWithoutOverrides=e(this.containsSectionsWithoutOverrides,this),this.overrideSectionIDs=e(this.overrideSectionIDs,this),this.removeOverride=e(this.removeOverride,this),this.addOverride=e(this.addOverride,this),this.availableSectionsPlusOverride=e(this.availableSectionsPlusOverride,this),this.availableSections=e(this.availableSections,this),this.getDefaultDueDate=e(this.getDefaultDueDate,this),this.findDefaultDueDateSection=e(this.findDefaultDueDateSection,this),this.updateDefaultDueDateSection=e(this.updateDefaultDueDateSection,this),this.courseSectionsLength=this.sections.length,this.sections.add(o.defaultDueDateSection()),n=this.overrides.length<this.courseSectionsLength||0===this.courseSectionsLength,u=ENV.DIFFERENTIATED_ASSIGNMENTS_ENABLED&&this.assignment.isOnlyVisibleToOverrides(),n&&!u&&(a=r.defaultDueDate({due_at:this.assignment.get("due_at"),lock_at:this.assignment.get("lock_at"),unlock_at:this.assignment.get("unlock_at")}),this.overrides.add(a)),this.updateDefaultDueDateSection(),this.overrides.on("add",this.updateDefaultDueDateSection),this.overrides.on("remove",this.updateDefaultDueDateSection)}return i.prototype.updateDefaultDueDateSection=function(){var e;return e=this.findDefaultDueDateSection(),null!=e?this.overrides.length<=1?e.set("name",n.t("overrides.everyone","Everyone"),{silent:!0}):e.set("name",n.t("overrides.everyone_else","Everyone Else"),{silent:!0}):void 0},i.prototype.findDefaultDueDateSection=function(){return this.sections.detect(function(e){return e.id===o.defaultDueDateSectionID})},i.prototype.getDefaultDueDate=function(){return this.overrides.getDefaultDueDate()},i.prototype.availableSections=function(){var e;return e=this.overrideSectionIDs(),this.sections.reject(function(i){var s;return s=i.id,t.call(e,s)>=0})},i.prototype.availableSectionsPlusOverride=function(e,t){var i;return null==t&&(t=this.availableSections()),i=this.sections.detect(function(t){return t.id===e.get("course_section_id")}),null!=i?t.concat(i):t},i.prototype.addOverride=function(e){return this.overrides.add(e)},i.prototype.removeOverride=function(e){return this.overrides.remove(e)},i.prototype.overrideSectionIDs=function(){return this.overrides.courseSectionIDs()},i.prototype.containsSectionsWithoutOverrides=function(){return this.overrides.containsDefaultDueDate()?!1:this.sectionsWithOverrides().length<this.courseSectionsLength},i.prototype.sectionIDs=function(){return this.sections.ids()},i.prototype.containsBlankOverrides=function(){return this.blankOverrides().length>0},i.prototype.blankOverrides=function(){return this.overrides.blank()},i.prototype.sectionsWithOverrides=function(){var e=this;return this.sections.select(function(i){var s;return s=i.id,t.call(e.overrideSectionIDs(),s)>=0&&i.id!==o.defaultDueDateSectionID})},i.prototype.sectionsWithoutOverrides=function(){var e=this;return this.sections.select(function(i){var s;return s=i.id,t.call(e.overrideSectionIDs(),s)<0&&i.id!==o.defaultDueDateSectionID})},i.prototype.toJSON=function(){return{overrides:this.overrides.toJSON(),sections:this.sections.toJSON()}},i}()})}).call(this);