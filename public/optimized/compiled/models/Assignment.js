(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function s(){this.constructor=t}for(var n in i)e.call(i,n)&&(t[n]=i[n]);return s.prototype=i.prototype,t.prototype=new s,t.__super__=i.prototype,t};define(["jquery","underscore","Backbone","compiled/backbone-ext/DefaultUrlMixin","compiled/models/TurnitinSettings","compiled/models/DateGroup","compiled/collections/AssignmentOverrideCollection","compiled/collections/DateGroupCollection","i18n!assignments"],function(s,n,o,r,u,h,p,l,a){var d,c,g;return c=o.Model,d=function(s){function o(){return this.setNullDates=t(this.setNullDates,this),this._filterFrozenAttributes=t(this._filterFrozenAttributes,this),this._getAssignmentType=t(this._getAssignmentType,this),this._hasOnlyType=t(this._hasOnlyType,this),this._submissionTypes=t(this._submissionTypes,this),this.toView=t(this.toView,this),this.singleSectionDueDate=t(this.singleSectionDueDate,this),this.allDates=t(this.allDates,this),this.multipleDueDates=t(this.multipleDueDates,this),this.defaultDates=t(this.defaultDates,this),this.postToSISEnabled=t(this.postToSISEnabled,this),this.labelId=t(this.labelId,this),this.htmlEditUrl=t(this.htmlEditUrl,this),this.htmlUrl=t(this.htmlUrl,this),this.objectType=t(this.objectType,this),this.iconType=t(this.iconType,this),this.published=t(this.published,this),this.isGpaScaled=t(this.isGpaScaled,this),this.isLetterGraded=t(this.isLetterGraded,this),this.isSimple=t(this.isSimple,this),this.externalToolNewTab=t(this.externalToolNewTab,this),this.externalToolUrl=t(this.externalToolUrl,this),this.gradingStandardId=t(this.gradingStandardId,this),this.groupCategoryId=t(this.groupCategoryId,this),this.turnitinEnabled=t(this.turnitinEnabled,this),this.gradeGroupStudentsIndividually=t(this.gradeGroupStudentsIndividually,this),this.turnitinAvailable=t(this.turnitinAvailable,this),this.allowedExtensions=t(this.allowedExtensions,this),this.restrictFileExtensions=t(this.restrictFileExtensions,this),this.notifyOfUpdate=t(this.notifyOfUpdate,this),this.peerReviewsAssignAt=t(this.peerReviewsAssignAt,this),this.peerReviewCount=t(this.peerReviewCount,this),this.automaticPeerReviews=t(this.automaticPeerReviews,this),this.peerReviews=t(this.peerReviews,this),this.isOnlineSubmission=t(this.isOnlineSubmission,this),this.acceptsOnlineTextEntries=t(this.acceptsOnlineTextEntries,this),this.acceptsMediaRecording=t(this.acceptsMediaRecording,this),this.acceptsOnlineURL=t(this.acceptsOnlineURL,this),this.acceptsOnlineUpload=t(this.acceptsOnlineUpload,this),this.withoutGradedSubmission=t(this.withoutGradedSubmission,this),this.allowedToSubmit=t(this.allowedToSubmit,this),this.expectsSubmission=t(this.expectsSubmission,this),this.submissionType=t(this.submissionType,this),this.submissionTypes=t(this.submissionTypes,this),this.courseID=t(this.courseID,this),this.gradingType=t(this.gradingType,this),this.frozenAttributes=t(this.frozenAttributes,this),this.frozen=t(this.frozen,this),this.freezeOnCopy=t(this.freezeOnCopy,this),this.canFreeze=t(this.canFreeze,this),this.assignmentGroupId=t(this.assignmentGroupId,this),this.pointsPossible=t(this.pointsPossible,this),this.postToSIS=t(this.postToSIS,this),this.name=t(this.name,this),this.description=t(this.description,this),this.lockAt=t(this.lockAt,this),this.unlockAt=t(this.unlockAt,this),this.dueAt=t(this.dueAt,this),this.assignmentType=t(this.assignmentType,this),this.isAssignment=t(this.isAssignment,this),this.isNotGraded=t(this.isNotGraded,this),this.isExternalTool=t(this.isExternalTool,this),this.isDiscussionTopic=t(this.isDiscussionTopic,this),this.isQuiz=t(this.isQuiz,this),g=o.__super__.constructor.apply(this,arguments)}return i(o,s),o.mixin(r),o.prototype.resourceName="assignments",o.prototype.urlRoot=function(){return this._defaultUrl()},o.prototype.defaults={publishable:!0,hidden:!1,unpublishable:!0},o.prototype.initialize=function(){var t,e,i;return null!=(e=this.get("assignment_overrides"))&&this.set("assignment_overrides",new p(e)),null!=(i=this.get("turnitin_settings"))&&this.set("turnitin_settings",new u(i),{silent:!0}),null!=(t=this.get("all_dates"))&&this.set("all_dates",new l(t)),this.postToSISEnabled()&&this.get("post_to_sis")!==!0&&this.get("post_to_sis")!==!1?this.set("post_to_sis",!0):void 0},o.prototype.isQuiz=function(){return this._hasOnlyType("online_quiz")},o.prototype.isDiscussionTopic=function(){return this._hasOnlyType("discussion_topic")},o.prototype.isExternalTool=function(){return this._hasOnlyType("external_tool")},o.prototype.isNotGraded=function(){return this._hasOnlyType("not_graded")},o.prototype.isAssignment=function(){return!n.include(this._submissionTypes(),"online_quiz","discussion_topic","not_graded","external_tool")},o.prototype.assignmentType=function(t){return arguments.length>0?"assignment"===t?this.set("submission_types",["none"]):this.set("submission_types",[t]):this._getAssignmentType()},o.prototype.dueAt=function(t){return arguments.length>0?this.set("due_at",t):this.get("due_at")},o.prototype.unlockAt=function(t){return arguments.length>0?this.set("unlock_at",t):this.get("unlock_at")},o.prototype.lockAt=function(t){return arguments.length>0?this.set("lock_at",t):this.get("lock_at")},o.prototype.description=function(t){return arguments.length>0?this.set("description",t):this.get("description")},o.prototype.name=function(t){return arguments.length>0?this.set("name",t):this.get("name")},o.prototype.postToSIS=function(){return arguments.length>0?void 0:this.get("post_to_sis")},o.prototype.pointsPossible=function(t){return arguments.length>0?this.set("points_possible",t):this.get("points_possible")||0},o.prototype.assignmentGroupId=function(t){return arguments.length>0?this.set("assignment_group_id",t):this.get("assignment_group_id")},o.prototype.canFreeze=function(){return null!=this.get("frozen_attributes")&&!this.frozen()},o.prototype.freezeOnCopy=function(){return this.get("freeze_on_copy")},o.prototype.frozen=function(){return this.get("frozen")},o.prototype.frozenAttributes=function(){return this.get("frozen_attributes")||[]},o.prototype.gradingType=function(t){return t?this.set("grading_type",t):this.get("grading_type")||"points"},o.prototype.courseID=function(){return this.get("course_id")},o.prototype.submissionTypes=function(t){return arguments.length>0?this.set("submission_types",t):this._submissionTypes()},o.prototype.submissionType=function(){var t;return t=this._submissionTypes(),n.include(t,"none")||0===t.length?"none":n.include(t,"on_paper")?"on_paper":n.include(t,"external_tool")?"external_tool":"online"},o.prototype.expectsSubmission=function(){var t;return t=this._submissionTypes(),t.length>0&&!n.include(t,"")&&!n.include(t,"none")&&!n.include(t,"not_graded")&&!n.include(t,"on_paper")&&!n.include(t,"external_tool")},o.prototype.allowedToSubmit=function(){var t;return t=this._submissionTypes(),this.expectsSubmission()&&!this.get("locked_for_user")&&!n.include(t,"online_quiz")&&!n.include(t,"attendance")},o.prototype.withoutGradedSubmission=function(){var t;return t=this.get("submission"),null==t||t.withoutGradedSubmission()},o.prototype.acceptsOnlineUpload=function(){return!!n.include(this._submissionTypes(),"online_upload")},o.prototype.acceptsOnlineURL=function(){return!!n.include(this._submissionTypes(),"online_url")},o.prototype.acceptsMediaRecording=function(){return!!n.include(this._submissionTypes(),"media_recording")},o.prototype.acceptsOnlineTextEntries=function(){return!!n.include(this._submissionTypes(),"online_text_entry")},o.prototype.isOnlineSubmission=function(){return n.any(this._submissionTypes(),function(t){return"online"===t||"online_text_entry"===t||"media_recording"===t||"online_url"===t||"online_upload"===t})},o.prototype.peerReviews=function(t){return arguments.length>0?this.set("peer_reviews",t):this.get("peer_reviews")},o.prototype.automaticPeerReviews=function(t){return arguments.length>0?this.set("automatic_peer_reviews",t):this.get("automatic_peer_reviews")},o.prototype.peerReviewCount=function(t){return arguments.length>0?this.set("peer_review_count",t):this.get("peer_review_count")||0},o.prototype.peerReviewsAssignAt=function(t){return arguments.length>0?this.set("peer_reviews_assign_at",t):this.get("peer_reviews_assign_at")||null},o.prototype.notifyOfUpdate=function(t){return arguments.length>0?this.set("notify_of_update",t):this.get("notify_of_update")},o.prototype.restrictFileExtensions=function(){return!!this.allowedExtensions()},o.prototype.allowedExtensions=function(t){return arguments.length>0?this.set("allowed_extensions",t):this.get("allowed_extensions")},o.prototype.turnitinAvailable=function(){return"undefined"!=typeof this.get("turnitin_enabled")},o.prototype.gradeGroupStudentsIndividually=function(t){return arguments.length>0?this.set("grade_group_students_individually",t):this.get("grade_group_students_individually")},o.prototype.turnitinEnabled=function(t){return 0===arguments.length?void 0===this.get("turnitin_enabled")?!1:!!this.get("turnitin_enabled"):this.set("turnitin_enabled",t)},o.prototype.groupCategoryId=function(t){return arguments.length>0?this.set("group_category_id",t):this.get("group_category_id")},o.prototype.canGroup=function(){return!this.get("has_submitted_submissions")},o.prototype.gradingStandardId=function(t){return arguments.length>0?this.set("grading_standard_id",t):this.get("grading_standard_id")},o.prototype.externalToolUrl=function(t){var e;return e=this.get("external_tool_tag_attributes")||{},arguments.length>0?(e.url=t,this.set("external_tool_tag_attributes",e)):e.url},o.prototype.externalToolNewTab=function(t){var e;return e=this.get("external_tool_tag_attributes")||{},arguments.length>0?(e.new_tab=t,this.set("external_tool_tag_attributes",e)):e.new_tab},o.prototype.isSimple=function(){var t;return t=this.get("assignment_overrides"),!("points"!==this.gradingType()||"none"!==this.submissionType()||this.groupCategoryId()||this.peerReviews()||this.frozen()||t&&!t.isSimple())},o.prototype.isLetterGraded=function(){return"letter_grade"===this.gradingType()},o.prototype.isGpaScaled=function(){return"gpa_scale"===this.gradingType()},o.prototype.published=function(t){return arguments.length>0?this.set("published",t):this.get("published")},o.prototype.position=function(t){return arguments.length>0?this.set("position",t):this.get("position")||0},o.prototype.iconType=function(){return this.isQuiz()?"quiz":this.isDiscussionTopic()?"discussion":"assignment"},o.prototype.objectType=function(){return this.isQuiz()?"Quiz":this.isDiscussionTopic()?"Discussion":"Assignment"},o.prototype.htmlUrl=function(){return this.get("html_url")},o.prototype.htmlEditUrl=function(){return""+this.get("html_url")+"/edit"},o.prototype.labelId=function(){return this.id},o.prototype.postToSISEnabled=function(){return ENV.POST_TO_SIS},o.prototype.defaultDates=function(){var t;return t=new h({due_at:this.get("due_at"),unlock_at:this.get("unlock_at"),lock_at:this.get("lock_at")})},o.prototype.multipleDueDates=function(){var t;return t=this.get("all_dates"),t&&t.length>1},o.prototype.allDates=function(){var t,e,i;return t=this.get("all_dates"),e=t&&t.models||[],i=n.map(e,function(t){return t.toJSON()})},o.prototype.singleSectionDueDate=function(){var t,e,i,s;if(this.multipleDueDates()||this.dueAt())return this.dueAt();for(t=this.allDates(),i=0,s=t.length;s>i;i++)if(e=t[i],e.dueAt)return e.dueAt.toISOString()},o.prototype.toView=function(){var t,e,i,s,n;for(e=["name","dueAt","description","pointsPossible","lockAt","unlockAt","gradingType","notifyOfUpdate","peerReviews","automaticPeerReviews","peerReviewCount","peerReviewsAssignAt","acceptsOnlineUpload","acceptsMediaRecording","submissionType","acceptsOnlineTextEntries","acceptsOnlineURL","allowedExtensions","restrictFileExtensions","isOnlineSubmission","isNotGraded","isExternalTool","externalToolUrl","externalToolNewTab","turnitinAvailable","turnitinEnabled","gradeGroupStudentsIndividually","groupCategoryId","frozen","frozenAttributes","freezeOnCopy","canFreeze","isSimple","gradingStandardId","isLetterGraded","isGpaScaled","assignmentGroupId","iconType","published","htmlUrl","htmlEditUrl","labelId","position","postToSIS","multipleDueDates","allDates","isQuiz","singleSectionDueDate"],ENV.DIFFERENTIATED_ASSIGNMENTS_ENABLED&&e.push("isOnlyVisibleToOverrides"),i={id:this.get("id")},s=0,n=e.length;n>s;s++)t=e[s],i[t]=this[t]();return i},o.prototype.toJSON=function(){var t;return t=o.__super__.toJSON.apply(this,arguments),t=this._filterFrozenAttributes(t),this.alreadyScoped?t:{assignment:t}},o.prototype.search=function(t){return this.get("name").match(t)?(this.set("hidden",!1),!0):(this.set("hidden",!0),!1)},o.prototype.endSearch=function(){return this.set("hidden",!1)},o.prototype.parse=function(t){var e,i;return t=o.__super__.parse.call(this,t),null!=(e=t.assignment_overrides)&&(t.assignment_overrides=new p(e)),null!=(i=t.turnitin_settings)&&(t.turnitin_settings=new u(i)),t},o.prototype.doNotParse=function(){return this.parse=function(){return{}}},o.prototype._submissionTypes=function(){return this.get("submission_types")||[]},o.prototype._hasOnlyType=function(t){var e;return e=this._submissionTypes(),1===e.length&&e[0]===t},o.prototype._getAssignmentType=function(){return this.isDiscussionTopic()?"discussion_topic":this.isQuiz()?"online_quiz":this.isExternalTool()?"external_tool":this.isNotGraded()?"not_graded":"assignment"},o.prototype._filterFrozenAttributes=function(t){var i,s,o;o=this.attributes;for(i in o)e.call(o,i)&&(s=o[i],n.contains(this.frozenAttributes(),i)&&delete t[i]);return n.contains(this.frozenAttributes(),"title")&&delete t.name,n.contains(this.frozenAttributes(),"group_category_id")&&delete t.grade_group_students_individually,n.contains(this.frozenAttributes(),"peer_reviews")&&(delete t.automatic_peer_reviews,delete t.peer_review_count,delete t.peer_reviews_assign_at),delete t.frozen,delete t.frozen_attributes,t},o.prototype.setNullDates=function(){return this.dueAt(null),this.lockAt(null),this.unlockAt(null),this},o.prototype.publish=function(){return this.save("published",!0)},o.prototype.unpublish=function(){return this.save("published",!1)},o.prototype.disabledMessage=function(){return a.t("cant_unpublish_when_students_submit","Can't unpublish if there are student submissions")},o.prototype.isOnlyVisibleToOverrides=function(t){return arguments.length>0?this.set("only_visible_to_overrides",t):this.get("only_visible_to_overrides")||!1},o}(c)})}).call(this);