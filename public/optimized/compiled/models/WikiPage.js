(function(){var t={}.hasOwnProperty,e=function(e,i){function s(){this.constructor=e}for(var n in i)t.call(i,n)&&(e[n]=i[n]);return s.prototype=i.prototype,e.prototype=new s,e.__super__=i.prototype,e};define(["underscore","Backbone","compiled/models/WikiPageRevision","compiled/backbone-ext/DefaultUrlMixin","compiled/str/splitAssetString","i18n!pages"],function(t,i,s,n,r,o){var a,p,u;return p=["contextAssetString","revision"],a=function(i){function a(){return u=a.__super__.constructor.apply(this,arguments)}return e(a,i),a.mixin(n),a.prototype.resourceName="pages",a.prototype.idAttribute="url",a.prototype.initialize=function(e,i){var s;return a.__super__.initialize.apply(this,arguments),t.extend(this,t.pick(i||{},p)),this.contextAssetString&&(s=r(this.contextAssetString),this.contextName=s[0],this.contextId=s[1]),this.on("change:front_page",this.setPublishable),this.on("change:published",this.setPublishable),this.setPublishable()},a.prototype.setPublishable=function(){var t,e,i,s;return e=this.get("front_page"),s=this.get("published"),i=!e||!s,t=!e,this.set("publishable",i),this.set("deletable",t),i?this.unset("publishableMessage"):this.set("publishableMessage",o.t("cannot_unpublish_front_page","Cannot unpublish the front page"))},a.prototype.disabledMessage=function(){return this.get("publishableMessage")},a.prototype.urlRoot=function(){return"/api/v1/"+this._contextPath()+"/pages"},a.prototype.url=function(){return this.get("url")?""+this.urlRoot()+"/"+this.get("url"):this.urlRoot()},a.prototype.latestRevision=function(e){var i;return!this._latestRevision&&this.get("url")&&(this._latestRevision||(i=t.extend({},{contextAssetString:this.contextAssetString,page:this,pageUrl:this.get("url"),latest:!0,summary:!0},e),this._latestRevision=new s({revision_id:this.revision},i))),this._latestRevision},a.prototype.parse=function(e){return e.wiki_page&&(e=t.extend(t.omit(e,"wiki_page"),e.wiki_page)),e},a.prototype.toJSON=function(){return{wiki_page:a.__super__.toJSON.apply(this,arguments)}},a.prototype.present=function(){return t.extend({},this.attributes,{contextName:this.contextName,contextId:this.contextId,new_record:!this.get("url")})},a.prototype.publish=function(){var t;return t={wiki_page:{published:!0}},this.save(t,{attrs:t,wait:!0})},a.prototype.unpublish=function(){var t;return t={wiki_page:{published:!1}},this.save(t,{attrs:t,wait:!0})},a.prototype.setFrontPage=function(){var t;return t={wiki_page:{front_page:!0}},this.save(t,{attrs:t,wait:!0})},a.prototype.unsetFrontPage=function(){var t;return t={wiki_page:{front_page:!1}},this.save(t,{attrs:t,wait:!0})},a}(i.Model)})}).call(this);