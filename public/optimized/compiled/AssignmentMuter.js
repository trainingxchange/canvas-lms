(function(){var t=function(t,n){return function(){return t.apply(n,arguments)}};define(["i18n!assignment_muter","jquery","jst/mute_dialog","jquery.ajaxJSON","jquery.disableWhileLoading","jqueryui/dialog","vendor/jquery.ba-tinypubsub"],function(n,i,e){var s;return s=function(){function s(n,e,s,u){var a=this;this.$link=n,this.assignment=e,this.url=s,this.setter=u,this.confirmUnmute=t(this.confirmUnmute,this),this.afterUpdate=t(this.afterUpdate,this),this.showDialog=t(this.showDialog,this),this.updateLink=t(this.updateLink,this),this.$link=i(this.$link),this.updateLink(),this.$link.click(function(t){return t.preventDefault(),a.assignment.muted?a.confirmUnmute():a.showDialog()})}return s.prototype.updateLink=function(){return this.$link.text(this.assignment.muted?n.t("unmute_assignment","Unmute Assignment"):n.t("mute_assignment","Mute Assignment"))},s.prototype.showDialog=function(){var t=this;return this.$dialog=i(e()).dialog({buttons:[{text:n.t("mute_assignment","Mute Assignment"),"data-text-while-loading":n.t("muting_assignment","Muting Assignment..."),click:function(){return t.$dialog.disableWhileLoading(i.ajaxJSON(t.url,"put",{status:!0},t.afterUpdate))}}],open:function(){return setTimeout(function(){return t.$dialog.find("#assignment_muter_content").focus()},100)},close:function(){return t.$dialog.remove()},resizable:!1,width:400})},s.prototype.afterUpdate=function(t){return this.setter?this.setter(this.assignment,"muted",t.assignment.muted):this.assignment.muted=t.assignment.muted,this.updateLink(),this.$dialog.dialog("close"),i.publish("assignment_muting_toggled",[this.assignment])},s.prototype.confirmUnmute=function(){var t=this;return this.$dialog=i("<div />").text(n.t("unmute_dialog","This assignment is currently muted. That means students can't see their grades and feedback. Would you like to unmute now?")).dialog({buttons:[{text:n.t("unmute_button","Unmute Assignment"),"data-text-while-loading":n.t("unmuting_assignment","Unmuting Assignment..."),click:function(){return t.$dialog.disableWhileLoading(i.ajaxJSON(t.url,"put",{status:!1},t.afterUpdate))}}],close:function(){return t.$dialog.remove()},resizable:!1,title:n.t("unmute_assignment","Unmute Assignment"),width:400})},s}()})}).call(this);