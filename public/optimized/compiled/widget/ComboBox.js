(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["jquery","underscore","Backbone","jst/ComboBox","str/htmlEscape","vendor/ui.selectmenu"],function(e,i,n,s,o){var u;return u=function(){function u(o,u){var r,h=this;this.items=o,null==u&&(u={}),this._formatOption=t(this._formatOption,this),this._buildOption=t(this._buildOption,this),this._next=t(this._next,this),this._previous=t(this._previous,this),null!=u.value&&(this._value=u.value),null!=u.label&&(this._label=u.label),this.$el=e(s()),this.$container=e(".ui-combobox-container",this.$el),this.$prev=e(".ui-combobox-prev",this.$el),this.$next=e(".ui-combobox-next",this.$el),this.$menu=e("select",this.$container),(r=this.$menu).append.apply(r,i.map(this.items,this._buildOption)),this.$menu.selectmenu({style:"dropdown",width:"230px",format:this._formatOption}),this.$selectmenu=this.$menu.data("selectmenu").list,null!=u.selected&&this.select(u.selected),i.extend(this,n.Events),this.$menu.change(function(){return h.trigger("change",h.selected())}),this.$prev.bind("click",this._previous),this.$next.bind("click",this._next)}return u.prototype.select=function(t){var e;return e=this._index(),this.$menu.selectmenu("value",t),this._index()!==e&&this.$menu.change(),this},u.prototype.selected=function(){return this.items[this._index()]},u.prototype._index=function(){return this.$menu[0].selectedIndex},u.prototype._previous=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=(this._index()+this.items.length-1)%this.items.length,this.select(this._value(this.items[e]))},u.prototype._next=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=(this._index()+1)%this.items.length,this.select(this._value(this.items[e]))},u.prototype._value=function(t){return t.value},u.prototype._label=function(t){return t.label},u.prototype._buildOption=function(t){return"<option value='"+this._value(t)+"'>"+o(this._label(t))+"</option>"},u.prototype._formatOption=function(t){return"<span class='ui-selectmenu-item'>"+o(t)+"</span>"},u}()})}).call(this);