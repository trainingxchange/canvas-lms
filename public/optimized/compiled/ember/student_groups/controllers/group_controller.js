(function(){define(["i18n!student_groups","ember","ic-ajax","jquery","compiled/jquery.rails_flash_notifications"],function(e,t,r,o){var n;return n=t.ObjectController.extend({currentUser:{},groupUrl:function(){return"/groups/"+this.get("id")}.property("id"),usersUrl:function(){return"/api/v1/groups/"+this.get("id")+"/memberships"}.property("id"),i18nStudentsCount:function(){return e.t("students_count","student",{count:this.get("memberCount")})}.property("memberCount"),showWhileSearching:function(){return this.get("parentController.filterText").length>0?this.set("showBody",!0):this.set("showBody",!1)}.observes("parentController.filterText").on("init"),memberCount:t.computed.alias("users.length"),isExpanded:function(){return""+this.get("showBody")}.property("showBody"),groupName:function(){return e.t("group_name","%{group_name} in %{group_category}",{group_name:this.get("name"),group_category:this.get("group_category.name")})}.property("name","group_category.name"),sgid:function(){return"student-group-"+this.get("id")}.property("id"),hasMultipleMembers:t.computed.not("memberCount",1),actions:{visitGroup:function(){return this.get("isMember")?window.location.href=this.get("groupUrl"):void 0},toggleBody:function(){var e;return this.get("memberCount")>0?(e="#"+this.get("sgid")+" ul.student-group-list",this.toggleProperty("showBody"),this.get("showBody")||(e="#"+this.get("sgid")+" .student-group-title"),t.run.scheduleOnce("afterRender",function(){return t.$(e).focus()})):this.set("showBody",!1)},join:function(t){var r,n;return n=this.store.createRecord("membership",{user_id:ENV.current_user_id,group_id:this.get("id")}),r=this,n.save().then(function(){return r.get("isStudentGroup")||r.parentController.removeFromCategory(r.get("group_category_id")),r.get("users").addObject(ENV.current_user),o.flashMessage(e.t("group_join","Joined Group %{group_name}",{group_name:t.name}))})},leave:function(n){var u,i=this;return u=this,t.run(function(){return r.request(""+i.get("usersUrl")+"/self",{type:"DELETE"}).then(function(){var t;return t=u.get("users").findBy("id",ENV.current_user_id),u.get("users").removeObject(t),o.flashMessage(e.t("group_leave","Left Group %{group_name}",{group_name:n.name})),0===u.get("memberCount")?u.set("showBody",!1):void 0})})}},isMember:function(){return null!=this.get("model").users.findBy("id",ENV.current_user_id)}.property("users.@each.id"),canSignup:function(){return"enabled"===this.get("group_category.self_signup")||"parent_context_auto_join"===this.get("join_level")}.property("group_category.self_signup","join_level"),isFull:function(){return null!=this.get("max_membership")&&this.get("memberCount")>=this.get("max_membership")}.property("memberCount"),isMemberOfCategory:function(){return this.parentController.isMemberOfCategory(this.get("group_category_id"))}.property("users.@each.id"),isStudentGroup:function(){return"student_organized"===this.get("group_category.role")}.property("group_category.role"),shouldSwitch:function(){return this.get("isMemberOfCategory")&&!this.get("isStudentGroup")}.property("isMemberOfCategory","isStudentGroup")})})}).call(this);