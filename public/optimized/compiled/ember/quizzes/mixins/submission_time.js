(function(){define(["ember","../shared/seconds_to_time","i18nObj"],function(i,t,e){var n,s,u,o;return s=1e3,n=60*s,o=60,u=1e3,i.Mixin.create({runningTime:void 0,timeSpent:i.computed.alias("quizSubmission.timeSpent"),timeLimit:i.computed.alias("quizSubmission.quiz.timeLimit"),endAt:i.computed.alias("quizSubmission.endAt"),dueAt:i.computed.alias("quizSubmission.quiz.dueAt"),lockAt:i.computed.alias("quizSubmission.quiz.lockAt"),isActive:function(){return this.get("quizSubmission.startedAt")&&!this.get("quizSubmission.finishedAt")}.property("quizSubmission.startedAt","quizSubmission.finishedAt"),friendlyEndsAt:function(){var i;return(i=this.get("endAt"))?e.l("date.formats.date_at_time",i):void 0}.property("endAt"),startStopRunningTime:function(){return this.get("isActive")&&this.get("okayToReload")?this.get("runningTime")?i.run.debounce(this,this.updateRunningTime,u):i.run.next(this,this.updateRunningTime):this.set("runningTime",void 0)}.observes("isActive","okayToReload").on("init"),friendlyTime:function(){var i,e;if(this.get("timeSpent"))return i=this.get("timeLimit"),e=this.get("timeSpent"),i&&(e=Math.min(e,i*o)),t(e)}.property("timeSpent"),updateRunningTime:function(){var i;return i=this.get("timeLimit")?this.calcRemainingSeconds():this.calcCurrentSeconds(),this.isTimeExpired()&&this.closeOutSubmission(),this.set("runningTime",t(i)),this.startStopRunningTime()},closeOutSubmission:function(){return this.set("quizSubmission.finishedAt",(new Date).toISOString()),this.set("quizSubmission.timeSpent",this.calcCurrentSeconds())},calcRemainingSeconds:function(){var i;return i=(new Date(this.get("endAt")).getTime()-(new Date).getTime())/s,Math.round(i)},calcCurrentSeconds:function(){var i;return i=new Date(this.get("quizSubmission.startedAt")),Math.floor((new Date-i)/s)},isTimeExpired:function(){return this.get("endAt")?this.calcRemainingSeconds()<=0:!1}})})}).call(this);