(function(){require(["INST","i18n!files.full_index","jquery","str/htmlEscape","jquery.ajaxJSON","jquery.instructure_date_and_time","jqueryui/dialog","jqueryui/progressbar","vendor/scribd.view"],function(e,i,o,s){return e.downloadFolderFiles=function(e){var l,t;return l=!1,o("#download_folder_files_dialog .status_box .status").text(i.t("messages.gathering_data","Gathering data...")),o("#download_folder_files_dialog").dialog({title:i.t("titles.download_folder_contents","Download Folder Contents"),close:function(){return l=!0}}),o("#download_folder_files_dialog .progress").progressbar({value:0}),(t=function(){var a;if(!l&&0!==o("#download_folder_files_dialog:visible").length)return o("#download_folder_files_dialog .status_loader").css("visibility","visible"),a=null,o.ajaxJSON(e,"GET",{},function(l){var r,d,n;if(l&&l.attachment){if(r=l.attachment,"zipped"===r.workflow_state)return o("#download_folder_files_dialog .progress").progressbar("value",100),d=s(i.t("messages.zip_finished","Finished!  Redirecting to File...")),d+="<br/><a href='"+s(e)+"'><b>",d+=s(i.t("links.download_zip","Click here to download %{size}",{size:r.readable_size})),d+="</b></a>",o("#download_folder_files_dialog .status").html(d),o("#download_folder_files_dialog .status_loader").css("visibility","hidden"),void(location.href=e);n=parseInt(r.file_state,10),isNaN(n)&&(n=0),n+=5,o("#download_folder_files_dialog .progress").progressbar("value",n),o("#download_folder_files_dialog .status").text(n>=95?i.t("messages.creating_zip","Creating zip file..."):i.t("messages.gathering_files_with_progress","Gathering Files (%{progress}%)...",{progress:n})),(5>=n||n===a)&&o.ajaxJSON(e+"?compile=1","GET",{},function(){},function(){}),a=n}return o("#download_folder_files_dialog .status_loader").css("visibility","hidden"),setTimeout(t,3e3)},function(){return o("#download_folder_files_dialog .status_loader").css("visibility","hidden"),setTimeout(t,1e3)})})()}})}).call(this);