define("translations/alerts",["i18nObj","jquery"],function(e,r){r.extend(!0,e,{translations:{ar:{alerts:{errors:{criteria_required:"مطلوب مشغل واحد على الأقل",recipients_required:"مطلوب مستلم واحد على الأقل",threshold_should_be_numeric:"من المفترض أن يكون رقمًا إيجابيًا"}}},de:{alerts:{errors:{criteria_required:"Mindestens ein Trigger ist erforderlich",recipients_required:"Mindestens ein Empfänger ist erforderlich",threshold_should_be_numeric:"Diese Zahl muss positiv sein"}}},"en-AU":{alerts:{errors:{criteria_required:"At least one trigger is required",recipients_required:"At least one recipient is required",threshold_should_be_numeric:"This should be a positive number"}}},"en-GB":{alerts:{errors:{criteria_required:"At least one trigger is required",recipients_required:"At least one recipient is required",threshold_should_be_numeric:"This should be a positive number"}}},es:{alerts:{errors:{criteria_required:"Al menos un activador de alarma es necesario",recipients_required:"Al menos un recipiente es necesario",threshold_should_be_numeric:"Este debería ser un número positivo"}}},"fa-IR":{alerts:{errors:{criteria_required:"حداقل یک محرک لازم است",recipients_required:"حداقل یک گیرنده لازم است",threshold_should_be_numeric:"باید یک عدد مثبت باشد"}}},fr:{alerts:{errors:{criteria_required:"Un déclencheur au moins est requis",recipients_required:"Un destinataire au moins est requis",threshold_should_be_numeric:"Le nombre indiqué doit être positif"}}},ja:{alerts:{errors:{criteria_required:"トリガーは最低1 つ必要です",recipients_required:"受信者は最低1 名必要です",threshold_should_be_numeric:"正数である必要があります。"}}},ko:{alerts:{errors:{criteria_required:"적어도 하나의 트리거가 필요함",recipients_required:"적어도 한 명의 수신인이 필요함",threshold_should_be_numeric:"양수이어야 함"}}},nb:{alerts:{errors:{criteria_required:"Minst en utløser er påkrevet",recipients_required:"Det må være minst én mottaker",threshold_should_be_numeric:"Dette skal være et positivt tall"}}},nl:{alerts:{errors:{criteria_required:"Er is minimaal een trigger nodig",recipients_required:"Er is minimaal een ontvanger nodig",threshold_should_be_numeric:"Dit moet een positief getal zijn"}}},pl:{alerts:{errors:{criteria_required:"Wymagana jest co najmniej jedna przyczyna",recipients_required:"Wymagany jest co najmniej jeden odbiorca",threshold_should_be_numeric:"Powinna to być liczba dodatnia"}}},pt:{alerts:{errors:{criteria_required:"É obrigatório pelo menos um disparador",recipients_required:"É obrigatório pelo menos um destinatário",threshold_should_be_numeric:"Este valor deve ser um número positivo."}}},"pt-BR":{alerts:{errors:{criteria_required:"É obrigatório pelo menos um disparador",recipients_required:"É obrigatório pelo menos um destinatário",threshold_should_be_numeric:"Este valor deve ser um número positivo."}}},ru:{alerts:{errors:{criteria_required:"Требуется хотя бы один триггер",recipients_required:"Требуется хотя бы один получатель",threshold_should_be_numeric:"Должно быть положительным числом"}}},tr:{alerts:{errors:{criteria_required:"En az bir tetikleyici gereklidir",recipients_required:"En az bir alıcı gereklidir",threshold_should_be_numeric:"Pozitif bir sayı olmalıdır"}}},zh:{alerts:{errors:{criteria_required:"至少需要一个触发器",recipients_required:"至少需要一个收件人",threshold_should_be_numeric:"这应该是正数"}}}}})}),define("alerts",["i18n!alerts","jquery","jquery.ajaxJSON","jquery.instructure_forms","jquery.instructure_misc_helpers","vendor/jquery.ba-tinypubsub","jqueryui/button"],function(e,r){r(function(){var i=r(".alerts_list"),t=function(e){var i=[];e.find("ul.criteria li").each(function(){i.push({id:r(this).find('input[name="alert[criteria][][id]"]').attr("value"),criterion_type:r(this).data("value"),threshold:r(this).find("span").text()})});var t=[];e.find("ul.recipients li").each(function(){t.push(r(this).data("value"))});var n=e.find('input[name="repetition"]:checked').attr("value");return n="value"==n?e.find('input[name="alert[repetition]"]').attr("value"):null,{criteria:i,recipients:t,repetition:n}},n=function(e,r){return e.append(r),r},a=function(e,t,n,a){var s=r("<"+t+" />");return s.data("value",e),s.html(a[e][n]),"li"==t?(s.append(" "),s.append(i.find(">.delete_item_link").clone().toggle())):s.attr("value",e),s},s=function(e,i){return $element=a(e,i,"label",ENV.ALERTS.POSSIBLE_RECIPIENTS),"li"==i&&$element.prepend(r("<input type='hidden' name='alert[recipients][]' />").attr("value",e)),$element},o=function(e,i){var t,n,s=e;return"object"==typeof e&&(s=e.criterion_type,t=e.threshold,n=e.id),$element=a(s,i,"li"==i?"label":"option",ENV.ALERTS.POSSIBLE_CRITERIA),"li"==i&&(t||(t=ENV.ALERTS.POSSIBLE_CRITERIA[s].default_threshold),$element.find("span").text(t),$element.find("input").attr("value",t).attr("title",ENV.ALERTS.POSSIBLE_CRITERIA[s].title),$element.prepend(r("<input type='hidden' name='alert[criteria][][criterion_type]' />").attr("value",s)),n&&$element.prepend(r("<input type='hidden' name='alert[criteria][][id]' />").attr("value",n))),$element},l=function(e,r){var i=e.find(".criteria");i.empty();for(var t in r.criteria)i.append(o(r.criteria[t],"li"));var n=e.find(".recipients");n.empty();for(var t in r.recipients)ENV.ALERTS.POSSIBLE_RECIPIENTS[r.recipients[t]]&&n.append(s(r.recipients[t],"li"));r.repetition?(e.find('input[name="repetition"][value="value"]').attr("checked",!0),e.find('input[name="alert[repetition]"]').attr("value",r.repetition),e.find(".repetition_group .no_repetition").toggle(!1),e.find(".repetition_group .repetition").toggle(!0).find("span").text(r.repetition)):(e.find('input[name="repetition"][value="none"]').attr("checked",!0),e.find(".repetition_group .no_repetition").toggle(!0),e.find(".repetition_group .repetition").toggle(!1))};for(var d in ENV.ALERTS.DATA){var u=ENV.ALERTS.DATA[d];l(r("#edit_alert_"+u.id),u)}r(".add_alert_link").click(function(e){e.preventDefault();var t=r(".alert.blank"),n=t.clone();n.removeClass("blank"),n.addClass("new"),0!=i.find(".alert:visible").length&&r('<div class="alert_separator"></div>').insertBefore(t);var a=Math.floor(1e8*Math.random());n.find("input").each(function(){r(this).attr("id",r.replaceTags(r(this).attr("id"),"id",a))}),n.find("label").each(function(){r(this).attr("for",r.replaceTags(r(this).attr("for"),"id",a))}),n.insertBefore(t),n.find(".edit_link").trigger("click"),n.toggle(!1),n.slideDown()}),i.delegate(".edit_link","click",function(){var e=r(this).parents(".alert"),i=t(e);e.data("data",i);var n=e.find(".add_criterion_link").prev();n.empty();var a=0;for(var l in ENV.ALERTS.POSSIBLE_CRITERIA_ORDER){var d=ENV.ALERTS.POSSIBLE_CRITERIA_ORDER[l],u=-1;for(var p in i.criteria)if(i.criteria[p].criterion_type==d){u=p;break}-1==u&&(n.append(o(d,"option")),a+=1)}0==a&&e.find(".add_criteria_line").toggle(!1);var c=e.find(".add_recipient_link").prev();c.empty(),a=0;for(var l in ENV.ALERTS.POSSIBLE_RECIPIENTS_ORDER){var _=ENV.ALERTS.POSSIBLE_RECIPIENTS_ORDER[l];-1==r.inArray(_,i.recipients)&&(c.append(s(_,"option")),a+=1)}return 0==a&&e.find(".add_recipients_line").toggle(!1),e.find(".repetition_group label").toggle(!0),e.toggleClass("editing"),e.toggleClass("displaying"),!1}).delegate(".delete_link","click",function(){var e=r(this).parents(".alert");return e.hasClass("new")?e.slideUp(function(){e.remove(),i.find(".alert:first").prev(".alert_separator").remove(),i.find(".alert_separator + .alert_separator").remove(),i.find(".alert:visible:last").next(".alert_separator").remove()}):(e.find('input[name="_method"]').attr("value","DELETE"),r.ajaxJSON(e.attr("action"),"POST",e.serialize(),function(){e.slideUp(function(){e.remove(),i.find(".alert:first").prev(".alert_separator").remove(),i.find(".alert_separator + .alert_separator").remove(),i.find(".alert:visible:last").next(".alert_separator").remove()})})),!1}).delegate(".cancel_button","click",function(){r(this).parent().hideErrors();var e=r(this).parents(".alert");if(e.hasClass("new"))e.slideUp(function(){e.remove(),i.find(".alert:first").prev(".alert_separator").remove(),i.find(".alert_separator + .alert_separator").remove(),i.find(".alert:visible:last").next(".alert_separator").remove()});else{var t=e.data("data");l(e,t),e.toggleClass("editing",!1),e.toggleClass("displaying",!0)}return!1}).delegate(".alert","submit",function(){var i=r(this),t=[];if(0==i.find(".criteria li").length&&t.push([i.find(".add_criterion_link").prev(),e.t("errors.criteria_required","At least one trigger is required")]),i.find(".criteria input.editing").each(function(){var i=r(this).attr("value");(!i||isNaN(i)||parseFloat(i)<0)&&t.push([r(this),e.t("errors.threshold_should_be_numeric","This should be a positive number")])}),0==i.find(".recipients li").length&&t.push([i.find(".add_recipient_link").prev(),e.t("errors.recipients_required","At least one recipient is required")]),"none"==i.find('input[name="repetition"]:checked').attr("value"))i.find('input[name="alert[repetition]"]').attr("value","");else{var n=i.find('input[name="alert[repetition]"]'),a=n.attr("value");(!a||isNaN(a)||parseFloat(a)<0)&&t.push([n,e.t("errors.threshold_should_be_numeric","This should be a positive number")])}return 0!=t.length?(i.formErrors(t),!1):(r.ajaxJSON(i.attr("action"),"POST",i.serialize(),function(e,t){i.removeClass("new"),i.attr("action",t.getResponseHeader("Location"));var n=i.find('input[name="_method"]');0==n.length&&i.append(r('<input type="hidden" name="_method" value="put" />')),i.toggleClass("editing",!1),i.toggleClass("displaying",!0),l(i,e)},function(e){i.formErrors(e)}),!1)}).delegate(".recipients .delete_item_link","click",function(){var e=r(this).parents("li"),i=r(this).parents(".alert").find(".add_recipient_link");return n(i.prev(),s(e.data("value"),"option")),e.slideUp(function(){e.remove()}),i.parent().slideDown(function(){i.parent().css("display","")}),!1}).delegate(".add_recipient_link","click",function(){var e=r(this).parents(".alert").find(".recipients"),i=r(this).prev(),t=i.attr("value");n(e,s(t,"li")).toggle().slideDown();var a=i.data("associated_error_box");return a&&a.fadeOut("slow",function(){a.remove()}),i.find('option[value="'+t+'"]').remove(),0==i.find("*").length&&r(this).parent().slideUp(),!1}).delegate(".criteria .delete_item_link","click",function(){var e=r(this).parents("li"),i=r(this).parents(".alert").find(".add_criterion_link");return n(i.prev(),o(e.data("value"),"option")),e.slideUp(function(){e.remove()}),i.parent().slideDown(function(){i.parent().css("display","")}),!1}).delegate(".add_criterion_link","click",function(){var e=r(this).parents(".alert").find(".criteria"),i=r(this).prev(),t=i.attr("value");n(e,o(t,"li")).toggle().slideDown();var a=i.data("associated_error_box");return a&&a.fadeOut("slow",function(){a.remove()}),i.find('option[value="'+t+'"]').remove(),0==i.find("*").length&&r(this).parent().slideUp(),!1}).delegate('input[name="repetition"]',"click",function(){var e=r(this).parents(".alert").find('input[name="alert[repetition]"]').data("associated_error_box");e&&e.fadeOut("slow",function(){e.remove()})})})}),function(){require(["alerts"])}.call(this),define("compiled/bundles/alerts",function(){});