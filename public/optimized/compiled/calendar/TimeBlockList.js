(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["jquery","i18n!calendar","compiled/calendar/TimeBlockListManager","compiled/calendar/TimeBlockRow","jquery.instructure_date_and_time","jquery.instructure_forms","vendor/date"],function(e,r,i,n){var o;return o=function(){function o(r,n,o){this.handleSplitClick=t(this.handleSplitClick,this),this.addRow=t(this.addRow,this);var s=this;this.element=e(r),this.splitterDiv=e(n),this.blocksManager=new i(o),this.splitterDiv.find(".split-link").click(this.handleSplitClick),this.element.delegate("input","change",function(t){return e(t.currentTarget).closest("tr").is(":last-child")?s.addRow():void 0}),this.render()}return o.prototype.render=function(){var t,e,r,i;for(this.rows=[],this.element.empty(),i=this.blocksManager.blocks,e=0,r=i.length;r>e;e++)t=i[e],this.addRow(t);return this.addRow()},o.prototype.rowRemoved=function(t){var e,r;return this.rows=function(){var i,n,o,s;for(o=this.rows,s=[],i=0,n=o.length;n>i;i++)r=o[i],r!==t&&(r.locked||(e=!0),s.push(r));return s}.call(this),e?void 0:this.addRow()},o.prototype.addRow=function(t){var e;return e=new n(this,t),this.element.append(e.$row),this.rows.push(e),e},o.prototype.handleSplitClick=function(t){var e;return t.preventDefault(),e=this.splitterDiv.find("[name=duration]").val(),this.split(e)},o.prototype.split=function(t){return t&&this.validate()?(this.blocksManager.split(t),this.render()):void 0},o.prototype.validate=function(){var t,e,i,n,o,s;for(e=!0,this.blocksManager.reset(),o=this.rows,i=0,n=o.length;n>i;i++)t=o[i],t.validate()?t.blank()||(s=this.blocksManager).add.apply(s,t.getData()):e=!1;return e||alert(r.t("time_block_errors","There are errors in your time block selections.")),e},o.prototype.blocks=function(){var t,e,r,i,n;for(i=this.blocksManager.blocks,n=[],e=0,r=i.length;r>e;e++)t=i[e],t.locked||n.push([t.start,t.end]);return n},o}()})}).call(this);