(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["i18n!appt_calendar_event_dialog","jquery","jst/calendar/editApptCalendarEvent"],function(e,i,n){var a;return a=function(){function a(a){var r,s=this;this.event=a,this.save=t(this.save,this),this.form=i("<div></div>").html(n(this.event)).appendTo("body"),r=this.form.find("[type=checkbox][name=max_participants_option]"),this.$maxParticipants=this.form.find("[name=max_participants]"),r.change(function(){return s.$maxParticipants.prop("disabled",!r.prop("checked"))}),this.event.calendarEvent.participants_per_appointment&&(r.click(),this.$maxParticipants.val(this.event.calendarEvent.participants_per_appointment)),this.dialog=this.form.dialog({autoOpen:!1,width:"auto",resizable:!1,title:e.t("title","Edit %{name}",{name:this.event.title}),buttons:[{text:e.t("update","Update"),click:this.save}]})}return a.prototype.show=function(){return this.dialog.dialog("open")},a.prototype.save=function(){var t,i,n,a;return t=this.dialog.getFormData(),i="1"===t.max_participants_option,n=t.max_participants,i&&0>=n?(this.$maxParticipants.errorBox(e.t("invalid_participants","You must allow at least one user to attend")),!1):(this.event.calendarEvent.description=t.description,i?(this.event.calendarEvent.total_slots=n,this.event.calendarEvent.remaining_slots=n-this.event.calendarEvent.child_events.length):(this.event.calendarEvent.total_slots=void 0,this.event.calendarEvent.remaining_slots=void 0),a=i?n:"",this.event.save({"calendar_event[description]":t.description,"calendar_event[participants_per_appointment]":a}),this.dialog.dialog("destroy"),this.form.remove())},a}()})}).call(this);