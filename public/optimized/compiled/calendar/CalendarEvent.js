(function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};define(["jquery","underscore","Backbone","compiled/str/splitAssetString"],function(t,n,r,o){var i,s;return i=function(i){function a(){return s=a.__super__.constructor.apply(this,arguments)}return e(a,i),a.prototype.urlRoot="/api/v1/calendar_events/",a.prototype.dateAttributes=["created_at","end_at","start_at","updated_at"],a.prototype._filterAttributes=function(t){var e;return e=n(t).pick("start_at","end_at","title","description","context_code","remove_child_events","location_name","location_address"),t.use_section_dates&&t.child_event_data&&(e.child_event_data=n.chain(t.child_event_data).compact().filter(this._hasValidInputs).map(this._filterAttributes).value()),e},a.prototype._hasValidInputs=function(t){return t.start_date&&!!t.start_time==!!t.end_time},a.prototype.toJSON=function(){return{calendar_event:this._filterAttributes(a.__super__.toJSON.apply(this,arguments))}},a.prototype.present=function(){return r.Model.prototype.toJSON.call(this)},a.prototype.fetch=function(e){var o,i,s,c,u,l,_;return null==e&&(e={}),e=n.clone(e),s=this,u=e.success,delete e.success,i=null!=(_=e.error)?_:function(){},delete e.error,this.get("id")&&(l=(this.sync||r.sync).call(this,"read",this,e)),this.get("sections_url")&&(c=t.getJSON(this.get("sections_url"))),o=function(t,r){var o,i,c,l,_;return null==t&&(t=[]),null==r&&(r=[]),c=t[0],l=t[1],_=t[2],i=r[0],o=a.mergeSectionsIntoCalendarEvent(c,n.sortBy(i,"id")),s.set(s.parse(o),e)?"function"==typeof u?u(s,o):void 0:!1},t.when(l,c).fail(i).done(o)},a.mergeSectionsIntoCalendarEvent=function(t,e){var r;return null==t&&(t={}),t.course_sections=e,t.use_section_dates=!!(null!=(r=t.child_events)?r.length:void 0),n(t.child_events).each(function(r,i){var s,c;return r=t.child_events[i]=a.prototype.parse(r),c=o(r.context_code)[1],s=n(e).find(function(t){return t.id===c}),s.event=r}),t},a}(r.Model)})}).call(this);