(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["i18n!calendar","jquery","jquery.ajaxJSON","vendor/jquery.ba-tinypubsub"],function(e,i){return function(){function n(e,i,n){this.save=t(this.save,this),this.removeClass=t(this.removeClass,this),this.addClass=t(this.addClass,this),this.isUndated=t(this.isUndated,this),this.contextCode=t(this.contextCode,this),this.isAppointmentGroupEvent=t(this.isAppointmentGroupEvent,this),this.isAppointmentGroupFilledEvent=t(this.isAppointmentGroupFilledEvent,this),this.isNewEvent=t(this.isNewEvent,this),this.eventType="generic",this.contextInfo=i,this.actualContextInfo=n,this.allPossibleContexts=null,this.className=[],this.object={},this.copyDataFromObject(e)}return n.prototype.readableTypes={assignment:e.t("event_type.assignment","Assignment"),discussion:e.t("event_type.discussion","Discussion"),event:e.t("event_type.event","Event"),quiz:e.t("event_type.quiz","Quiz")},n.prototype.isNewEvent=function(){var t;return"generic"===this.eventType||!(null!=(t=this.object)?t.id:void 0)},n.prototype.isAppointmentGroupFilledEvent=function(){var t,e;return(null!=(t=this.object)&&null!=(e=t.child_events)?e.length:void 0)>0},n.prototype.isAppointmentGroupEvent=function(){var t;return null!=(t=this.object)?t.appointment_group_url:void 0},n.prototype.contextCode=function(){var t,e,i;return(null!=(t=this.object)?t.effective_context_code:void 0)||(null!=(e=this.object)?e.context_code:void 0)||(null!=(i=this.contextInfo)?i.asset_string:void 0)},n.prototype.isUndated=function(){return null===this.start},n.prototype.displayTimeString=function(){return""},n.prototype.readableType=function(){return""},n.prototype.fullDetailsURL=function(){return null},n.prototype.startDate=function(){return this.originalStart||this.date},n.prototype.endDate=function(){return this.startDate()},n.prototype.possibleContexts=function(){return this.allPossibleContexts||[this.contextInfo]},n.prototype.addClass=function(t){var e,i,n,s,o;for(i=!1,o=this.className,n=0,s=o.length;s>n;n++)if(e=o[n],e===t){i=!0;break}return i?void 0:this.className.push(t)},n.prototype.removeClass=function(t){var e,i,n,s,o,r;for(i=0,o=this.className,r=[],n=0,s=o.length;s>n;n++)e=o[n],r.push(e===t?this.className.splice(i,1):i+=1);return r},n.prototype.save=function(t,e,n){var s,o,r,u,a,h=this;return r=function(t){return h.copyDataFromObject(t),i.publish("CommonEvent/eventSaved",h),"function"==typeof e?e():void 0},o=function(){return i.publish("CommonEvent/eventSaveFailed",h),"function"==typeof n?n():void 0},a=this.methodAndURLForSave(),s=a[0],u=a[1],this.forceMinimumDuration(),i.publish("CommonEvent/eventSaving",this),i.ajaxJSON(u,s,t,r,o)},n.prototype.isDueAtMidnight=function(){return this.start&&(this.midnightFudged||23===this.start.getHours()&&this.start.getMinutes()>30)},n.prototype.copyDataFromObject=function(){return this.originalStart=this.start?new Date(this.start):void 0,this.midnightFudged=!1,this.isDueAtMidnight()&&(this.midnightFudged=!0,this.start.setMinutes(30),this.start.setSeconds(0),this.end||(this.end=new Date(this.start.getTime()))),this.forceMinimumDuration()},n.prototype.forceMinimumDuration=function(){var t;return t=18e5,this.start&&this.end&&this.end.getTime()-this.start.getTime()<t?this.end=new Date(this.start.getTime()+t):void 0},n.prototype.assignmentType=function(){var t,e;if(this.assignment){if(null!=(e=this.assignment.submission_types)?e.length:void 0){if(t=this.assignment.submission_types[0],"online_quiz"===t)return"quiz";if("discussion_topic"===t)return"discussion"}return"assignment"}},n.prototype.iconType=function(){var t;return(t=this.assignmentType())?t:"calendar-month"},n}()})}).call(this);