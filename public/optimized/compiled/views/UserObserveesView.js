(function(){var e={}.hasOwnProperty,t=function(t,o){function r(){this.constructor=t}for(var n in o)e.call(o,n)&&(t[n]=o[n]);return r.prototype=o.prototype,t.prototype=new r,t.__super__=o.prototype,t};define(["underscore","i18n!observees","jst/UserObservees","compiled/views/UserObserveeView","compiled/views/PaginatedCollectionView"],function(e,o,r,n,s){var i,u;return i=function(i){function p(){return u=p.__super__.constructor.apply(this,arguments)}return t(p,i),p.prototype.autoFetch=!0,p.prototype.template=r,p.prototype.itemView=n,p.prototype.className="user-observees",p.prototype.events={"submit .add-observee-form":"addObservee"},p.prototype.els=e.extend({},s.prototype.els,{".add-observee-form":"$form"}),p.prototype.initialize=function(){var e=this;return p.__super__.initialize.apply(this,arguments),this.collection.on("beforeFetch",function(){return e.setLoading(!0)}),this.collection.on("fetch",function(){return e.setLoading(!1)})},p.prototype.addObservee=function(e){var t,r,n=this;return e.preventDefault(),r=this.$form.getFormData(),t=$.post(this.collection.url(),{observee:r}),t.done(function(e){return n.collection.add([e],{merge:!0}),$.flashMessage(o.t("observee_added","Now observing %{user}",{user:e.name})),n.$form.get(0).reset(),n.focusForm()}),t.error(function(e){return n.$form.formErrors(JSON.parse(e.responseText)),n.focusForm()})},p.prototype.focusForm=function(){var e;return e=this.$form.find(":input[value='']:not(button)").first(),e.length||(e=this.$form.find(":input:not(button)")),e.focus()},p.prototype.setLoading=function(e){return this.$el.toggleClass("loading",e),this.$(".observees-list-container").attr("aria-busy",e?"true":"false")},p}(s)})}).call(this);