(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,r=function(e,r){function o(){this.constructor=e}for(var n in r)t.call(r,n)&&(e[n]=r[n]);return o.prototype=r.prototype,e.prototype=new o,e.__super__=r.prototype,e};define(["compiled/models/CreateUserList","underscore","i18n!create_users_view","compiled/views/DialogFormView","jst/courses/roster/createUsers","jst/EmptyDialogFormWrapper","vendor/jquery.placeholder"],function(t,o,n,i,s,l){var p,a;return p=function(i){function p(){return this.toJSON=e(this.toJSON,this),this.maybeShowPrivileges=e(this.maybeShowPrivileges,this),a=p.__super__.constructor.apply(this,arguments)}return r(p,i),p.optionProperty("rolesCollection"),p.optionProperty("courseModel"),p.prototype.defaults={width:700,height:500},p.prototype.els={"#privileges":"$privileges","#user_list_textarea":"$textarea"},p.prototype.events=o.extend({},p.prototype.events,{"click .createUsersStartOver":"startOver","click .createUsersStartOverFrd":"startOverFrd","change #enrollment_type":"changeEnrollment","click #enrollment_type":"changeEnrollment","click .dialog_closer":"close"}),p.prototype.template=s,p.prototype.wrapperTemplate=l,p.prototype.initialize=function(){var e;return null==(e=this.model)&&(this.model=new t),p.__super__.initialize.apply(this,arguments)},p.prototype.attach=function(){return this.model.on("change:step",this.render,this),this.model.on("change:enrollment_type",this.maybeShowPrivileges)},p.prototype.maybeShowPrivileges=function(){var e,t;return e=o.findWhere(this.model.get("roles"),{name:this.model.get("enrollment_type")}),!e||"TeacherEnrollment"!==(t=e.base_role_name)&&"TaEnrollment"!==t?this.$privileges.hide():this.$privileges.show()},p.prototype.changeEnrollment=function(e){return this.model.set("enrollment_type",e.target.value)},p.prototype.openAgain=function(){return this.startOverFrd(),p.__super__.openAgain.apply(this,arguments)},p.prototype.hasUsers=function(){var e;return null!=(e=this.model.get("users"))?e.length:void 0},p.prototype.onSaveSuccess=function(){var e,t,r;return this.model.incrementStep(),3===this.model.get("step")?(t=this.rolesCollection.where({name:this.model.get("enrollment_type")})[0],null!=t&&t.increment("count",this.model.get("users").length),e=this.model.get("users").length,null!=(r=this.courseModel)?r.increment("pendingInvitationsCount",e):void 0):void 0},p.prototype.validateBeforeSave=function(e){return 1!==this.model.get("step")||e.user_list?{}:{user_list:[{type:"required",message:n.t("required","Please enter some email addresses")}]}},p.prototype.startOver=function(){return this.model.startOver()},p.prototype.startOverFrd=function(){var e;return this.model.startOver(),null!=(e=this.$textarea)?e.val(""):void 0},p.prototype.toJSON=function(){var e;return e=p.__super__.toJSON.apply(this,arguments),e.course_section_id=""+e.course_section_id,e.limit_privileges_to_course_section=e.limit_privileges_to_course_section===!0||"1"===e.limit_privileges_to_course_section,e},p.prototype.afterRender=function(){return this.$("[placeholder]").placeholder(),this.maybeShowPrivileges(),$("#user_email_errors").focus()},p}(i)})}).call(this);