(function(){var e={}.hasOwnProperty,t=function(t,i){function s(){this.constructor=t}for(var n in i)e.call(i,n)&&(t[n]=i[n]);return s.prototype=i.prototype,t.prototype=new s,t.__super__=i.prototype,t};define(["jquery","underscore","Backbone","jst/roles/permissionButton"],function(e,i,s,n){var o,r;return o=function(s){function o(){return r=o.__super__.constructor.apply(this,arguments)}return t(o,s),o.prototype.template=n,o.prototype.tagName="td",o.prototype.className="permissionButtonView",o.prototype.events={"change input[type=radio]":"updateRole"},o.prototype.initialize=function(){return o.__super__.initialize.apply(this,arguments),this.options.permission_name?this.permission_name=this.options.permission_name:void 0},o.prototype.toJSON=function(){var e;return e=o.__super__.toJSON.apply(this,arguments),e.enableChecked=this.isEnabled(),e.enableAndLockChecked=this.isEnabledAndLocked(),e.disableChecked=this.isDisabled(),e.disableAndLockChecked=this.isDisabledAndLocked(),e.systemDefaultChecked=this.isDefault(),e.systemDefaultLockedChecked=this.isDefaultAndLocked(),e.readOnly=this.isReadOnly(),e["default"]=this.isDefault()||this.isDefaultAndLocked(),e.addDefaultTitle=this.isDefault()||this.isDefaultAndLocked()&&!this.isReadOnly(),e},o.prototype.afterRender=function(){return this.setPreviewIcons(),this.setDataAttributes(),this.setTooltips()},o.prototype.setDataAttributes=function(){return this.$el.attr("data-role_name",this.model.id),this.$el.attr("data-permission_name",this.permission_name)},o.prototype.setTooltips=function(){return this.isReadOnly()||this.$el.find(".icon-check").attr("title","Enabled").attr("data-tooltip",""),this.isReadOnly()||this.$el.find(".icon-x").attr("title","Disabled").attr("data-tooltip",""),this.isReadOnly()?void 0:this.$el.find(".icon-lock").attr("title","Locked").attr("data-tooltip","")},o.prototype.setPreviewIcons=function(){return this.isEnabled()?this.setEnabledIcon():this.isEnabledAndLocked()?this.setEnabledLockedIcon():this.isDisabled()?this.setDisabledIcon():this.isDisabledAndLocked()?this.setDisabledLockedIcon():this.isDefault()?this.setDefaultIcon():this.isDefaultAndLocked()?this.setDefaultAndLockedIcon():void 0},o.prototype.updateRole=function(t){switch(t.preventDefault(),e(t.target).attr("id")){case"button-"+this.cid+"-0":this.$el.find("a.btn").removeClass("default_permission"),this.enable();break;case"button-"+this.cid+"-1":this.$el.find("a.btn").removeClass("default_permission"),this.enableAndLock();break;case"button-"+this.cid+"-2":this.$el.find("a.btn").removeClass("default_permission"),this.disable();break;case"button-"+this.cid+"-3":this.$el.find("a.btn").removeClass("default_permission"),this.disableAndLock();break;case"button-"+this.cid+"-4":this.$el.find("a.btn").addClass("default_permission"),this.setSystemDefault();break;case"button-"+this.cid+"-5":this.$el.find("a.btn").addClass("default_permission"),this.setSystemDefaultAndLocked()}return this.setPreviewIcons(),this.closeMenu(),this.saveModel()},o.prototype.saveModel=function(){return this.model.save({},{failure:function(){return alert("Permission was not be saved!")}})},o.prototype.closeMenu=function(){return this.$el.children(".btn-group").removeClass("open")},o.prototype.enable=function(){return this.model.get("permissions")[this.permission_name].enabled=!0,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!1},o.prototype.enableAndLock=function(){return this.model.get("permissions")[this.permission_name].enabled=!0,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!0},o.prototype.disable=function(){return this.model.get("permissions")[this.permission_name].enabled=!1,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!1},o.prototype.disableAndLock=function(){return this.model.get("permissions")[this.permission_name].enabled=!1,this.model.get("permissions")[this.permission_name].explicit=!0,this.model.get("permissions")[this.permission_name].locked=!0},o.prototype.setSystemDefault=function(){return this.model.get("permissions")[this.permission_name].locked=!1,this.model.get("permissions")[this.permission_name].explicit=!1},o.prototype.setSystemDefaultAndLocked=function(){return this.model.get("permissions")[this.permission_name].locked=!0,this.model.get("permissions")[this.permission_name].explicit=!1},o.prototype.isEnabled=function(){return this.model.get("permissions")[this.permission_name].enabled&&!this.isLocked()&&this.isExplicit()},o.prototype.isEnabledAndLocked=function(){return this.model.get("permissions")[this.permission_name].enabled&&this.isLocked()&&this.isExplicit()},o.prototype.isDisabled=function(){return!this.model.get("permissions")[this.permission_name].enabled&&!this.isLocked()&&this.isExplicit()},o.prototype.isDisabledAndLocked=function(){return!this.model.get("permissions")[this.permission_name].enabled&&this.isLocked()&&this.isExplicit()},o.prototype.isDefault=function(){return!this.isExplicit()&&!this.isLocked()},o.prototype.isDefaultAndLocked=function(){return!this.isExplicit()&&this.isLocked()},o.prototype.isReadOnly=function(){return this.model.get("permissions")[this.permission_name].readonly},o.prototype.isExplicit=function(){return this.model.get("permissions")[this.permission_name].explicit},o.prototype.isLocked=function(){return this.model.get("permissions")[this.permission_name].locked},o.prototype.setButtonPreview=function(e){var t;return t=this.$el.find("label[for=button-"+this.cid+"-"+e+"] i").clone(),this.$el.find("a.dropdown-toggle").html(t)},o.prototype.setEnabledIcon=function(){return this.setButtonPreview(0)},o.prototype.setEnabledLockedIcon=function(){return this.setButtonPreview(1)},o.prototype.setDisabledIcon=function(){return this.setButtonPreview(2)},o.prototype.setDisabledLockedIcon=function(){return this.setButtonPreview(3)},o.prototype.setDefaultIcon=function(){return i.isUndefined(this.model.get("permissions")[this.permission_name].prior_default)?this.model.get("permissions")[this.permission_name].enabled?this.setEnabledIcon():this.setDisabledIcon():this.model.get("permissions")[this.permission_name].prior_default?this.setEnabledIcon():this.setDisabledIcon()},o.prototype.setDefaultAndLockedIcon=function(){return i.isUndefined(this.model.get("permissions")[this.permission_name].prior_default)?this.model.get("permissions")[this.permission_name].enabled?this.setEnabledLockedIcon():this.setDisabledLockedIcon():this.model.get("permissions")[this.permission_name].prior_default?this.setEnabledLockedIcon():this.setDisabledLockedIcon()},o}(s.View)})}).call(this);