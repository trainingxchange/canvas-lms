(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var s in n)t.call(n,s)&&(e[s]=n[s]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define(["i18n!assignments","compiled/views/KeyboardNavDialog","jst/KeyboardNavDialog","jquery","underscore","Backbone","jst/publish_grades/IndexView","jst/publish_grades/NoAssignmentsSearch","compiled/views/publish_grades/AssignmentKeyBindingsMixin"],function(t,i,s,r,o,u,a,c,l){var p,h;return p=function(t){function p(){return this.filterKeyBindings=e(this.filterKeyBindings,this),this.focusOnAssignments=e(this.focusOnAssignments,this),this.filterResults=e(this.filterResults,this),h=p.__super__.constructor.apply(this,arguments)}return n(p,t),p.mixin(l),p.prototype.template=a,p.prototype.el=".publish-gradebook-container",p.child("assignmentGroupsView","[data-view=assignmentGroups]"),p.child("createGroupView","[data-view=createGroup]"),p.child("assignmentSettingsView","[data-view=assignmentSettings]"),p.child("showByView","[data-view=showBy]"),p.prototype.events={"keyup #search_term":"search"},p.prototype.els={"#addGroup":"$addGroupButton","#assignmentSettingsCog":"$assignmentSettingsButton"},p.prototype.initialize=function(){return p.__super__.initialize.apply(this,arguments)},p.prototype.afterRender=function(){return this.userIsStudent()&&this.filterKeyBindings(),this.kbDialog=(new i).render(s({keyBindings:this.keyBindings})),window.onkeydown=this.focusOnAssignments},p.prototype.enableSearch=function(){return this.$("#search_term").prop("disabled",!1)},p.prototype.clearSearch=function(){return this.$("#search_term").val(""),this.filterResults()},p.prototype.search=o.debounce(function(){return this.filterResults()},200),p.prototype.filterResults=function(){var e,t,n,i;if(n=r("#search_term").val(),""===n){if(this.collection.each(function(e){return e.groupView.endSearch()}),null!=this.noAssignments)return this.noAssignments.remove(),this.noAssignments=null}else if(t=new RegExp(this.cleanSearchTerm(n),"ig"),e=!1,this.collection.each(function(n){return n.groupView.search(t)?e=!0:void 0}),e){if(null!=this.noAssignments)return this.noAssignments.remove(),this.noAssignments=null}else if(!this.noAssignments)return this.noAssignments=new u.View({template:c,tagName:"li",className:"item-group-condensed"}),i=this.assignmentGroupsView.$el.children(".collectionViewItems"),i.append(this.noAssignments.render().el)},p.prototype.cleanSearchTerm=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},p.prototype.focusOnAssignments=function(e){return 74!==e.keyCode||r(e.target).is("input")?void 0:r(".assignment_group").filter(":visible").first().attr("tabindex",-1).focus()},p.prototype.userIsStudent=function(){return o.include(ENV.current_user_roles,"student")},p.prototype.filterKeyBindings=function(){return this.keyBindings=this.keyBindings.filter(function(e){return!o.contains([69,68,65],e.keyCode)})},p}(u.View)})}).call(this);