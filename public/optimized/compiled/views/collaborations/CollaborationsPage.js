(function(){var o=function(o,t){return function(){return o.apply(t,arguments)}},t={}.hasOwnProperty,i=function(o,i){function e(){this.constructor=o}for(var r in i)t.call(i,r)&&(o[r]=i[r]);return e.prototype=i.prototype,o.prototype=new e,o.__super__=i.prototype,o};define(["jquery","underscore","Backbone","compiled/views/collaborations/CollaborationView","compiled/views/collaborations/CollaborationFormView"],function(t,e,r,n,a){var s,l,h,c,d;return h=e.each,c=e.reject,l=r.View,s=function(e){function r(){return this.onFormError=o(this.onFormError,this),this.onFormHide=o(this.onFormHide,this),this.onCollaborationDelete=o(this.onCollaborationDelete,this),this.initPageState=o(this.initPageState,this),d=r.__super__.constructor.apply(this,arguments)}return i(r,e),r.prototype.events={"click .add_collaboration_link":"addCollaboration"},r.prototype.initialize=function(){return r.__super__.initialize.apply(this,arguments),this.cacheElements(),this.createViews(),this.attachEvents()},r.prototype.initPageState=function(){return 0===t("#collaborations .collaboration:visible").length?(this.addFormView.render(!1),this.$addLink.hide()):void 0},r.prototype.cacheElements=function(){return this.$header=t("h1:first"),this.$addLink=t(".add_collaboration_link"),this.$addForm=t("#new_collaboration"),this.$noCollaborationsMessage=t("#no_collaborations_message")},r.prototype.createViews=function(){return this.addFormView=new a({el:this.$addForm}),this.collaborationViews=t("div.collaboration").map(function(){return new n({el:t(this)})})},r.prototype.attachEvents=function(){var o=this;return this.addFormView.on("hide",this.onFormHide).on("error",this.onFormError),h(this.collaborationViews,function(t){return t.on("delete",o.onCollaborationDelete)})},r.prototype.addCollaboration=function(o){return o.preventDefault(),this.$addLink.hide(),this.addFormView.render(),this.$el.scrollTo(this.addFormView.$el)},r.prototype.onCollaborationDelete=function(o){return this.collaborationViews=c(this.collaborationViews,function(t){return t===o}),0===this.collaborationViews.length?(this.$noCollaborationsMessage.show(),this.addFormView.render(!1)):void 0},r.prototype.onFormHide=function(){return this.$addLink.show(),this.$header.focus()},r.prototype.onFormError=function(o,t){return o.focus().errorBox(t)},r}(l)})}).call(this);