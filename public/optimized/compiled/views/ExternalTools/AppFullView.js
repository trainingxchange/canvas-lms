(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,r=function(e,r){function i(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return i.prototype=r.prototype,e.prototype=new i,e.__super__=r.prototype,e};define(["Backbone","jquery","jst/ExternalTools/AppFullView","compiled/views/PaginatedCollectionView","compiled/views/ExternalTools/AppReviewView","compiled/views/ExternalTools/RateToolView","compiled/collections/PaginatedCollection","compiled/models/AppReview","vendor/jquery.raty"],function(t,i,o,n,p,a,s,c){var l,u;return l=function(t){function n(){return this.addApp=e(this.addApp,this),this.renderItem=e(this.renderItem,this),u=n.__super__.constructor.apply(this,arguments)}return r(n,t),n.prototype.template=o,n.prototype.itemView=p,n.prototype.className="app_full",n.prototype.events={"click .add_app":"addApp","click .app_cancel":"cancel","click .rate_app":"rateApp"},n.prototype.initialize=function(){return this.collection=new s,n.__super__.initialize.apply(this,arguments),this.render(),i(document).scrollTop(0),this.collection.resourceName="app_center/apps/"+this.model.id+"/reviews",this.collection.fetch()},n.prototype.afterRender=function(){return this.$(".app-star").raty({readOnly:!0,score:this.model.get("average_rating"),path:"/images/raty/"})},n.prototype.renderItem=function(e){var t;return t=e.get("comments"),t&&t.length>0?n.__super__.renderItem.apply(this,arguments):void 0},n.prototype.refresh=function(){return this.collection.resourceName.match(/force_refresh/)||(this.collection.resourceName=""+this.collection.resourceName+"?force_refresh=1"),this.collection.fetch()},n.prototype.addApp=function(e){return e&&e.preventDefault(),this.trigger("addApp",this)},n.prototype.cancel=function(e){return e&&e.preventDefault(),this.trigger("cancel",this)},n.prototype.rateApp=function(e){var t=this;return e&&e.preventDefault(),i("#rate_app_loader").show(),this.review=new c,this.review.on("sync",this.refresh,this),this.review.resourceName="app_center/apps/"+this.model.id+"/reviews/self",this.rateAppView=new a({model:this.review}),this.review.fetch({success:function(){return t.rateAppView.render(),i("#rate_app_loader").hide()},error:function(){return t.rateAppView.render(),i("#rate_app_loader").hide()}})},n}(n)})}).call(this);