(function(){var t={}.hasOwnProperty,s=function(s,i){function e(){this.constructor=s}for(var o in i)t.call(i,o)&&(s[o]=i[o]);return e.prototype=i.prototype,s.prototype=new e,s.__super__=i.prototype,s};define(["i18n!discussions","jquery","compiled/fn/preventDefault","Backbone"],function(t,i,e,o){var r,n,c;return n=o.View,r=function(i){function e(){return c=e.__super__.constructor.apply(this,arguments)}return s(e,i),e.prototype.tagName="a",e.prototype.attributes={href:"#"},e.prototype.messages={subscribe:t.t("subscribe","Subscribe to this topic"),subscribed:t.t("subscribed","Subscribed"),unsubscribe:t.t("unsubscribe","Unsubscribe from this topic"),unsubscribed:t.t("unsubscribed","Unsubscribed"),initial_post_required:t.t("initial_post_required_to_subscribe","You must post a reply before subscribing"),not_in_group_set:t.t("cant_subscribe_not_in_group_set","You must be in an associated group to subscribe"),not_in_group:t.t("cant_subscribe_not_in_group","You must be in this group to subscribe")},e.prototype.tooltipOptions={items:"*",position:{my:"center bottom",at:"center top-10",collision:"none"},tooltipClass:"center bottom vertical"},e.prototype.events={click:"click",hover:"hover"},e.prototype.initialize=function(){return this.model.on("change:subscribed",this.render),this.model.on("change:user_can_see_posts",this.render),this.model.on("change:subscription_hold",this.render),e.__super__.initialize.apply(this,arguments)},e.prototype.hover=function(t){var s;return s=t.type,this.hovering="mouseenter"===s,this.displayStateDuringHover=!1,this.render()},e.prototype.click=function(t){return t.preventDefault(),this.subscribed()?(this.model.topicUnsubscribe(),this.displayStateDuringHover=!0):this.canSubscribe()&&(this.model.topicSubscribe(),this.displayStateDuringHover=!0),this.render()},e.prototype.subscribed=function(){return this.model.get("subscribed")&&this.canSubscribe()},e.prototype.canSubscribe=function(){return!this.subscriptionHold()},e.prototype.subscriptionHold=function(){return this.model.get("subscription_hold")},e.prototype.classAndTextForTooltip=function(){return this.hovering?this.subscribed()?this.displayStateDuringHover?["icon-discussion-check",this.messages.subscribed]:["icon-discussion-x",this.messages.unsubscribe]:this.displayStateDuringHover?["icon-discussion",this.messages.unsubscribed]:this.canSubscribe()?["icon-discussion-check",this.messages.subscribe]:["icon-discussion-x",this.messages[this.subscriptionHold()]]:[this.subscribed()?"icon-discussion-check":"icon-discussion",""]},e.prototype.resetTooltipText=function(t){return this.$el.tooltip(this.tooltipOptions),this.$el.tooltip("close"),this.$el.tooltip("option",{content:function(){return t}}),this.$el.tooltip("open")},e.prototype.afterRender=function(){var t,s,i;return i=this.classAndTextForTooltip(),t=i[0],s=i[1],this.resetTooltipText(s),this.$el.removeClass("icon-discussion icon-discussion-x icon-discussion-check"),this.$el.addClass(t),this},e}(n)})}).call(this);