(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,o=function(t,o){function n(){this.constructor=t}for(var s in o)e.call(o,s)&&(t[s]=o[s]);return n.prototype=o.prototype,t.prototype=new n,t.__super__=o.prototype,t};define(["i18n!assignments","jquery","underscore","compiled/models/AssignmentGroup","compiled/views/DialogFormView","jst/assignments/DeleteGroup","jst/EmptyDialogFormWrapper","jquery.disableWhileLoading"],function(e,n,s,i,r,p,u){var l,a;return l=function(i){function r(){return this.removeFromGroupOptions=t(this.removeFromGroupOptions,this),this.addToGroupOptions=t(this.addToGroupOptions,this),this.updateAssignmentCount=t(this.updateAssignmentCount,this),a=r.__super__.constructor.apply(this,arguments)}return o(r,i),r.prototype.defaults={width:500,height:275},r.prototype.els={".assignment_count":"$assignmentCount",".group_select":"$groupSelect"},r.prototype.events=s.extend({},r.prototype.events,{"click .dialog_closer":"close","click .delete_group":"destroy","change .group_select":"selectMove"}),r.prototype.template=p,r.prototype.wrapperTemplate=u,r.prototype.initialize=function(){return r.__super__.initialize.apply(this,arguments),this.model.get("assignments").on("add remove",this.updateAssignmentCount),this.model.collection.on("add",this.addToGroupOptions),this.model.collection.on("remove",this.removeFromGroupOptions)},r.prototype.toJSON=function(){var t,e,o,n=this;return t=r.__super__.toJSON.apply(this,arguments),e=this.model.collection.reject(function(t){return t.get("id")===n.model.get("id")}),o=e.map(function(t){return t.toJSON()}),s.extend(t,{assignment_count:this.model.get("assignments").length,groups:o,label_id:t.id})},r.prototype.updateAssignmentCount=function(){return this.$assignmentCount.text(this.model.get("assignments").length)},r.prototype.addToGroupOptions=function(t){var e,o;return o=t.get("id"),e=n("<option>"),e.val(o),e.addClass("ag_"+o),e.text(t.get("name")),this.$groupSelect.append(e)},r.prototype.removeFromGroupOptions=function(t){var e;return e=t.get("id"),this.$groupSelect.find("move_to_ag_"+e).remove()},r.prototype.destroy=function(){var t,e=this;return t=this.getFormData(),"move"===t.action&&t.move_assignments_to&&this.destroyModel(t.move_assignments_to).then(function(){return e.close()}),"delete"===t.action?this.destroyModel().then(function(){return e.close()}):void 0},r.prototype.destroyModel=function(t){var e,o,n=this;return null==t&&(t=null),this.collection=this.model.collection,e=t?"move_assignments_to="+t:"",o=this.model.destroy({data:e,wait:!0}),o.then(function(){return t?n.collection.fetch({reset:!0}):void 0}),this.$el.disableWhileLoading(o),o},r.prototype.selectMove=function(){return this.$el.find(".group_select :selected").hasClass("blank")?void 0:this.$el.find(".assignment_group_move").prop("checked",!0)},r.prototype.openAgain=function(){return this.model.collection.models.length>1?this.model.get("assignments").length>0?r.__super__.openAgain.apply(this,arguments):confirm(e.t("confirm_delete_group","Are you sure you want to delete this Assignment Group?"))?this.destroyModel():void 0:alert(e.t("cannot_delete_group","You must have at least one Assignment Group"))},r}(r)})}).call(this);