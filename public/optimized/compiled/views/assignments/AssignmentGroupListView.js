(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,r=function(t,r){function i(){this.constructor=t}for(var n in r)e.call(r,n)&&(t[n]=r[n]);return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t};define(["jquery","underscore","Backbone","compiled/views/SortableCollectionView","compiled/views/assignments/AssignmentGroupListItemView","jst/assignments/AssignmentGroupList","jst/assignments/NoAssignmentsListItem"],function(e,i,n,s,o,a,p){var c,l;return c=function(n){function s(){return this.expand=t(this.expand,this),this.collapse=t(this.collapse,this),this.handleExtraClick=t(this.handleExtraClick,this),this.renderOnReset=t(this.renderOnReset,this),this.renderItem=t(this.renderItem,this),this.render=t(this.render,this),l=s.__super__.constructor.apply(this,arguments)}return r(s,n),s.optionProperty("course"),s.prototype.template=a,s.prototype.itemView=o,s.optionProperty("assignment_sort_base_url"),s.prototype.render=function(){return s.__super__.render.call(this,ENV.PERMISSIONS.manage)},s.prototype.renderItem=function(t){var e;return e=s.__super__.renderItem.apply(this,arguments),t.groupView.collapseIfNeeded(),e},s.prototype.createItemView=function(t){var r;return r={parentCollection:this.collection,childKey:"assignments",groupKey:"assignment_group_id",groupId:t.id,reorderURL:this.createReorderURL(t.id),noItemTemplate:p},new this.itemView(e.extend({},this.itemViewOptions||{},{model:t},r))},s.prototype.createReorderURL=function(t){return this.assignment_sort_base_url+"/"+t+"/reorder"},s.prototype.attachCollection=function(){return s.__super__.attachCollection.apply(this,arguments),this.itemViewOptions={course:this.course},this.collection.on("render",this.render),this.collection.on("add",this.render),this.collection.on("remove",this.render),this.collection.on("change:groupWeights",this.render)},s.prototype.renderOnReset=function(){return this.firstResetLanded=!0,s.__super__.renderOnReset.apply(this,arguments)},s.prototype.toJSON=function(){var t;return t=s.__super__.toJSON.apply(this,arguments),i.extend({},t,{firstResetLanded:this.firstResetLanded})},s.prototype._initSort=function(){return s.__super__._initSort.apply(this,arguments),this.$list.on("sortstart",this.collapse),this.$list.on("sortstop",this.expand)},s.prototype.handleExtraClick=function(t){return t.stopImmediatePropagation(),e(t.target).off("click",this.handleExtraClick)},s.prototype.collapse=function(t,e){var r,i,n;return n=e.item,i=n.children(":first").attr("data-id"),n.find("#assignment_group_"+i+"_assignments").slideUp(100),e.item.css("height","auto"),r=n.find("i").first(),r.removeClass("icon-mini-arrow-down").addClass("icon-mini-arrow-right")},s.prototype.expand=function(t,e){var r,i,n,s,o,a=this;return o=e.item,r=o.find(".element_toggler").first(),r.on("click",this.handleExtraClick),setTimeout(function(){return r.off("click",a.handleExtraClick)},50),s=o.children(":first").attr("data-id"),i=this.collection.findWhere({id:s}),i&&i.groupView.shouldBeExpanded()?(o.find("#assignment_group_"+s+"_assignments").slideDown(100),n=o.find("i").first(),n.addClass("icon-mini-arrow-down").removeClass("icon-mini-arrow-right")):void 0},s}(s)})}).call(this);