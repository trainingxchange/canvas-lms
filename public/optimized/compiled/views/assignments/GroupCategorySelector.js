(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,o=function(t,o){function r(){this.constructor=t}for(var a in o)e.call(o,a)&&(t[a]=o[a]);return r.prototype=o.prototype,t.prototype=new r,t.__super__=o.prototype,t};define(["i18n!assignment","Backbone","underscore","jquery","jst/assignments/GroupCategorySelector","compiled/jquery/toggleAccessibly"],function(e,r,a,i,n){var s,p;return s=function(r){function s(){return this._validateGroupCategoryID=t(this._validateGroupCategoryID,this),this.validateBeforeSave=t(this.validateBeforeSave,this),this.filterFormData=t(this.filterFormData,this),this.toJSON=t(this.toJSON,this),this.toggleGroupCategoryOptions=t(this.toggleGroupCategoryOptions,this),this.showGroupCategoryCreateDialog=t(this.showGroupCategoryCreateDialog,this),p=s.__super__.constructor.apply(this,arguments)}var g,u,d;return o(s,r),s.prototype.template=n,g="#assignment_group_category_id",d="#assignment_has_group_category",u="#group_category_options",s.prototype.els=function(){var t;return t={},t[""+g]="$groupCategoryID",t[""+d]="$hasGroupCategory",t[""+u]="$groupCategoryOptions",t}(),s.prototype.events=function(){var t;return t={},t["change "+g]="showGroupCategoryCreateDialog",t["change "+d]="toggleGroupCategoryOptions",t}(),s.optionProperty("parentModel"),s.optionProperty("groupCategories"),s.optionProperty("nested"),s.optionProperty("hideGradeIndividually"),s.optionProperty("sectionLabel"),s.optionProperty("fieldLabel"),s.optionProperty("lockedMessage"),s.prototype.showGroupCategoryCreateDialog=function(){var t=this;return"new"===this.$groupCategoryID.val()?window.addGroupCategory(function(e){var o,r;return r=e[0].group_category,o=i("<option>"),o.val(r.id),o.text(r.name),t.$groupCategoryID.prepend(o),t.$groupCategoryID.val(r.id),t.groupCategories.push(r)}):void 0},s.prototype.toggleGroupCategoryOptions=function(){return this.$groupCategoryOptions.toggleAccessibly(this.$hasGroupCategory.prop("checked")),this.$hasGroupCategory.prop("checked")&&0===this.groupCategories.length?this.showGroupCategoryCreateDialog():void 0},s.prototype.toJSON=function(){var t,e,o,r;return t=("function"==typeof(r=this.parentModel).frozenAttributes?r.frozenAttributes():void 0)||[],e=a.include(t,"group_category_id"),o=!this.parentModel.canGroup(),{groupCategoryId:this.parentModel.groupCategoryId(),groupCategories:this.groupCategories,hideGradeIndividually:this.hideGradeIndividually,gradeGroupStudentsIndividually:!this.hideGradeIndividually&&this.parentModel.gradeGroupStudentsIndividually(),groupCategoryLocked:o,hasGroupCategoryDisabled:e||o,gradeIndividuallyDisabled:e,groupCategoryIdDisabled:e||o,sectionLabel:this.sectionLabel,fieldLabel:this.fieldLabel,lockedMessage:this.lockedMessage,nested:this.nested,prefix:this.nested?"assignment":void 0}},s.prototype.filterFormData=function(t){var e;return e=t.has_group_category,delete t.has_group_category,"0"===e&&(t.group_category_id=null,t.grade_group_students_individually=!1),t},s.prototype.fieldSelectors={groupCategorySelector:"#assignment_group_category_id"},s.prototype.validateBeforeSave=function(t,e){return e=this._validateGroupCategoryID(t,e)},s.prototype._validateGroupCategoryID=function(t,o){var r;return r=this.nested?t.assignment.groupCategoryId():t.group_category_id,"new"===r&&(o.groupCategorySelector=[{message:e.t("group_assignment_must_have_group_set","Please select a group set for this assignment")}]),o},s}(r.View)})}).call(this);