(function(){var e={}.hasOwnProperty,t=function(t,i){function n(){this.constructor=t}for(var o in i)e.call(i,o)&&(t[o]=i[o]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define(["jquery","underscore","Backbone","compiled/views/CollectionView","compiled/views/wiki/WikiPageRevisionView","jst/wiki/WikiPageRevisions","compiled/jquery/floatingSticky"],function(e,i,n,o,r,s){var l,c;return l=function(n){function o(){return c=o.__super__.constructor.apply(this,arguments)}return t(o,n),o.prototype.className="show-revisions",o.prototype.template=s,o.prototype.itemView=r,o.mixin({events:{"click .prev-button":"prevPage","click .next-button":"nextPage","click .close-button":"close"},els:{"#ticker":"$ticker",aside:"$aside",".revisions-list":"$revisionsList"}}),o.optionProperty("pages_path"),o.prototype.initialize=function(){var e=this;return o.__super__.initialize.apply(this,arguments),this.selectedRevision=null,this.on("selectionChanged",function(e,t){var i,n;return null!=(i=t.model)&&i.set("selected",!1),null!=(n=e.model)?n.set("selected",!0):void 0}),this.on("render renderItem",function(){return e.reposition()})},o.prototype.afterRender=function(){return o.__super__.afterRender.apply(this,arguments),e.publish("userContent/change"),this.trigger("render"),this.floatingSticky=this.$aside.floatingSticky("#main",{top:"#content"})},o.prototype.remove=function(){return this.floatingSticky&&(i.each(this.floatingSticky,function(e){return e.remove()}),this.floatingSticky=null),o.__super__.remove.apply(this,arguments)},o.prototype.renderItem=function(){return o.__super__.renderItem.apply(this,arguments),this.trigger("renderItem")},o.prototype.attachItemView=function(e,t){var i,n=this;return this.selectedRevision&&this.selectedRevision.get("revision_id")===e.get("revision_id")?(e.set(this.selectedRevision.attributes),e.set("selected",!0),this.setSelectedModelAndView(e,t)):e.set("selected",!1),i=function(){return n.setSelectedModelAndView(e,t)},this.selectedModel||i(),t.pages_path=this.pages_path,t.$el.on("click",i)},o.prototype.setSelectedModelAndView=function(e,t){var i,n;return i=this.selectedModel,n=this.selectedView,this.selectedModel=e,this.selectedView=t,this.selectedRevision=e,this.trigger("selectionChanged",{model:e,view:t},{model:i,view:n})},o.prototype.reposition=function(){return this.floatingSticky?i.each(this.floatingSticky,function(e){return e.reposition()}):void 0},o.prototype.prevPage=function(e){return null!=e&&e.preventDefault(),this.$el.disableWhileLoading(this.collection.fetch({page:"prev",reset:!0}))},o.prototype.nextPage=function(e){return null!=e&&e.preventDefault(),this.$el.disableWhileLoading(this.collection.fetch({page:"next",reset:!0}))},o.prototype.close=function(e){return null!=e&&e.preventDefault(),window.location.href=this.collection.parentModel.get("html_url")},o.prototype.toJSON=function(){var e;return e=o.__super__.toJSON.apply(this,arguments),e.CAN={FETCH_PREV:this.collection.canFetch("prev"),FETCH_NEXT:this.collection.canFetch("next")},e},o}(o)})}).call(this);