(function(){var o=function(o,t){return function(){return o.apply(t,arguments)}},t={}.hasOwnProperty,e=function(o,e){function r(){this.constructor=o}for(var n in e)t.call(e,n)&&(o[n]=e[n]);return r.prototype=e.prototype,o.prototype=new r,o.__super__=e.prototype,o};define(["jquery","underscore","compiled/views/groups/manage/GroupUsersView","compiled/views/groups/manage/AssignToGroupMenu","compiled/views/groups/manage/Scrollable","compiled/views/Filterable","jst/groups/manage/groupUsers"],function(t,r,n,s,i,p){var u,l;return u=function(u){function c(){return this._onDrop=o(this._onDrop,this),l=c.__super__.constructor.apply(this,arguments)}return e(c,u),c.optionProperty("groupsCollection"),c.optionProperty("category"),c.prototype.defaults=r.extend({},n.prototype.defaults,{autoFetch:!0,itemViewOptions:{canAssignToGroup:!0,canEditGroupAssignment:!1}}),c.prototype.els=r.extend({},n.prototype.els,{".no-results-wrapper":"$noResultsWrapper",".no-results":"$noResults"}),c.mixin(p,i),c.prototype.dropOptions={accept:".group-user",activeClass:"droppable",hoverClass:"droppable-hover",tolerance:"pointer"},c.prototype.attach=function(){var o=this;return this.collection.on("reset",this.render),this.collection.on("remove",this.render),this.collection.on("moved",this.highlightUser),this.collection.on("filterOut",r(function(){return o.checkScroll()}).debounce(50)),this.collection.once("fetch",function(){return o.$noResultsWrapper.hide()}),this.collection.on("fetched:last",function(){return o.$noResultsWrapper.show()})},c.prototype.afterRender=function(){return this.$filter=this.$externalFilter,c.__super__.afterRender.apply(this,arguments),this.collection.load("first"),this.$el.parent().droppable(r.extend({},this.dropOptions)).on("drop",this._onDrop),this.scrollContainer=this.heightContainer=this.$el,this.$scrollableElement=this.$el.find("ul")},c.prototype.toJSON=function(){return{loading:!this.collection.loadedAll,count:this.collection.length,ENV:ENV}},c.prototype.remove=function(){var o;return null!=(o=this.assignToGroupMenu)&&o.remove(),c.__super__.remove.apply(this,arguments)},c.prototype.events={"click .assign-to-group":"showAssignToGroup","focus .assign-to-group":"showAssignToGroup","blur .assign-to-group":"hideAssignToGroup",scroll:"hideAssignToGroup"},c.prototype.showAssignToGroup=function(o){var e,r;return o.preventDefault(),o.stopPropagation(),e=t(o.currentTarget),null==(r=this.assignToGroupMenu)&&(this.assignToGroupMenu=new s({collection:this.groupsCollection})),this.assignToGroupMenu.model=this.collection.get(e.data("user-id")),this.assignToGroupMenu.showBy(e)},c.prototype.hideAssignToGroup=function(){var o;return null!=(o=this.assignToGroupMenu)?o.hide():void 0},c.prototype.canAssignToGroup=function(){return this.options.canAssignToGroup&&this.groupsCollection.length},c.prototype._onDrop=function(o,t){var e,r=this;return e=t.draggable.data("model"),setTimeout(function(){return r.category.reassignUser(e,null)})},c}(n)})}).call(this);