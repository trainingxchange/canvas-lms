(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,i=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e};define(["Backbone","jquery","compiled/views/PaginatedCollectionView","compiled/views/accounts/admin_tools/DateRangeSearchView","compiled/views/accounts/admin_tools/AutocompleteView","compiled/views/ValidatedMixin","compiled/views/accounts/admin_tools/GradeChangeLoggingItemView","compiled/collections/GradeChangeLoggingCollection","compiled/collections/CourseCollection","jst/accounts/admin_tools/gradeChangeLoggingContent","jst/accounts/admin_tools/gradeChangeLoggingResults"],function(t,n,o,r,s,a,c,d,l,u,h){var g;return g=function(t){function l(t){this.options=t,this.onFail=e(this.onFail,this),this.fetch=e(this.fetch,this),this.collection=new d,l.__super__.constructor.apply(this,arguments),this.dateRangeSearch=new r({name:"gradeChangeLogging"}),this.graderSearch=new s({collection:this.options.users,fieldName:"grader_id",placeholder:"Grader"}),this.studentSearch=new s({collection:this.options.users,fieldName:"student_id",placeholder:"Student"}),this.resultsView=new o({template:h,itemView:c,collection:this.collection})}return i(l,t),l.mixin(a),l.child("resultsView","#gradeChangeLoggingSearchResults"),l.child("dateRangeSearch","#gradeChangeDateRangeSearch"),l.child("graderSearch","#gradeChangeGraderSearch"),l.child("studentSearch","#gradeChangeStudentSearch"),l.prototype.els={"#gradeChangeLoggingSearch":"$gradeChangeLogginSearch","#gradeChangeLoggingForm":"$form"},l.prototype.template=u,l.prototype.events={"submit #gradeChangeLoggingForm":"onSubmit"},l.prototype.onSubmit=function(e){var t;return e.preventDefault(),t=this.$form.toJSON(),this.validate(t)?this.updateCollection(t):void 0},l.prototype.updateCollection=function(e){var t;return e||(e=this.$form.toJSON()),t={id:null,type:null,start_time:"",end_time:""},e.start_time&&(t.start_time=e.start_time),e.end_time&&(t.end_time=e.end_time),e.grader_id&&(t.type="graders",t.id=e.grader_id),e.student_id&&(t.type="students",t.id=e.student_id),e.course_id&&(t.type="courses",t.id=e.course_id),e.assignment_id&&(t.type="assignments",t.id=e.assignment_id),this.collection.setParams(t)},l.prototype.validate=function(e){var t;return e||(e=this.$form.toJSON()),delete e.gradeChange_submit,t=this.dateRangeSearch.validate(e)||{},e.course_id||e.student_id||e.grader_id||e.assignment_id||(t.gradeChange_submit=[{type:"required",message:"A valid Grader, Student, Course Id, or Assignment Id is required to search events."}]),this.showErrors(t),n.isEmptyObject(t)},l.prototype.attach=function(){return this.collection.on("setParams",this.fetch)},l.prototype.fetch=function(){return this.collection.fetch().fail(this.onFail)},l.prototype.onFail=function(e){var t,i;return this.collection.reset(),this.resultsView.detachScroll(),this.resultsView.$el.find(".paginatedLoadingIndicator").fadeOut(),null==(null!=e?e.status:void 0)||404!==e.status||(i=this.collection.options.params.type,t={},"courses"===i&&(t.course_id=[{type:"required",message:"A course with that ID could not be found for this account."}]),"assignments"===i&&(t.assignment_id=[{type:"required",message:"An assignment with that ID could not be found for this account."}]),n.isEmptyObject(t))?void 0:this.showErrors(t)},l}(t.View)})}).call(this);