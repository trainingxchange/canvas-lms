(function(){var t=function(t,i){return function(){return t.apply(i,arguments)}},i={}.hasOwnProperty,e=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};define(["jquery","compiled/views/ValidatedFormView","compiled/fn/preventDefault","jst/DialogFormWrapper","jqueryui/dialog","compiled/jquery/fixDialogButtons"],function(i,r,o,n){var s,l;return s=function(r){function s(){return this.onSaveSuccess=t(this.onSaveSuccess,this),this.renderElAgain=t(this.renderElAgain,this),this.firstRenderEl=t(this.firstRenderEl,this),this.toggle=t(this.toggle,this),l=s.__super__.constructor.apply(this,arguments)}return e(s,r),s.prototype.defaults={trigger:!1,title:null,width:null,height:null,fixDialogButtons:!0},s.prototype.$dialogAppendTarget=i("body"),s.prototype.className="dialogFormView",s.prototype.wrapperTemplate=n,s.prototype.initialize=function(){return s.__super__.initialize.apply(this,arguments),this.setTrigger(),this.open=this.firstOpen,this.renderEl=this.firstRenderEl},s.prototype.open=null,s.prototype.close=function(){var t,i;return(null!=(t=this.dialog)?t.isOpen():void 0)&&this.dialog.close(),null!=(i=this.focusReturnsTo())?i.focus():void 0},s.prototype.toggle=function(){var t;return(null!=(t=this.dialog)?t.isOpen():void 0)?this.close():this.open()},s.prototype.remove=function(){var t,i;return s.__super__.remove.apply(this,arguments),null!=(t=this.$trigger)&&t.off(".dialogFormView"),null!=(i=this.$dialog)&&i.remove(),this.open=this.firstOpen,this.renderEl=this.firstRenderEl},s.prototype.firstOpen=function(){return this.insert(),this.render(),this.setupDialog(),this.openAgain(),this.open=this.openAgain},s.prototype.openAgain=function(){return this.dialog.open(),this.dialog.uiDialog.focus()},s.prototype.insert=function(){return this.$el.appendTo(this.$dialogAppendTarget)},s.prototype.setTrigger=function(t){return t&&(this.options.trigger=t),this.options.trigger?(this.$trigger=i(this.options.trigger),this.attachTrigger()):void 0},s.prototype.attachTrigger=function(){var t;return null!=(t=this.$trigger)?t.on("click.dialogFormView",o(this.toggle)):void 0},s.prototype.renderEl=null,s.prototype.firstRenderEl=function(){return this.$el.html(this.wrapperTemplate(this.toJSON())),this.renderElAgain(),this.renderEl=this.renderElAgain},s.prototype.renderElAgain=function(){var t;return t=this.template(this.toJSON()),this.$el.find(".outlet").html(t)},s.prototype.getDialogTitle=function(){var t;return this.options.title||(null!=(t=this.$trigger)?t.attr("title"):void 0)||this.getAriaTitle()},s.prototype.getAriaTitle=function(){var t,e;return t=null!=(e=this.$trigger)?e.attr("aria-describedby"):void 0,i("#"+t).text()},s.prototype.setupDialog=function(){var t,i=this;return t={autoOpen:!1,title:this.getDialogTitle(),close:function(){return i.close(),i.trigger("close")},open:function(){return i.trigger("open")}},t.width=this.options.width,t.height=this.options.height,this.$el.dialog(t),this.options.fixDialogButtons&&this.$el.fixDialogButtons(),this.dialog=this.$el.data("dialog")},s.prototype.setDimensions=function(t,i){var e;return t=null!=t?t:this.options.width,i=null!=i?i:this.options.height,e={width:t,height:i},this.$el.dialog(e)},s.prototype.onSaveSuccess=function(){return s.__super__.onSaveSuccess.apply(this,arguments),this.close()},s.prototype.focusReturnsTo=function(){var t;return this.$trigger?(t=this.$trigger.data("focusReturnsTo"))?i("#"+t):this.$trigger:null},s}(r)})}).call(this);