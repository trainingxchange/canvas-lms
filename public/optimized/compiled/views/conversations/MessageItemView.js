(function(){var t={}.hasOwnProperty,e=function(e,r){function o(){this.constructor=e}for(var n in r)t.call(r,n)&&(e[n]=r[n]);return o.prototype=r.prototype,e.prototype=new o,e.__super__=r.prototype,e};define(["i18n!conversations","jquery","underscore","Backbone","jst/conversations/messageItem","jst/_avatar"],function(t,r,o,n,i){var a,s,p;return s=n.View,a=function(o){function n(){return p=n.__super__.constructor.apply(this,arguments)}return e(n,o),n.prototype.tagName="li",n.prototype.className="message-item-view",n.prototype.template=i,n.prototype.els={".message-participants-toggle":"$toggle",".message-participants":"$participants",".summarized-message-participants":"$summarized",".full-message-participants":"$full",".message-metadata":"$metadata"},n.prototype.events={"blur .actions a":"onActionBlur","click .al-trigger":"onMenuOpen","click .delete-btn":"onDelete","click .forward-btn":"onForward","click .message-participants-toggle":"onToggle","click .reply-btn":"onReply","click .reply-all-btn":"onReplyAll","focus .actions a":"onActionFocus"},n.prototype.messages={confirmDelete:t.t("confirm.delete_message","Are you sure you want to delete your copy of this message? This action cannot be undone.")},n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.summarized=this.model.get("summarizedParticipantNames")},n.prototype.toJSON=function(){return this.model.toJSON()},n.prototype.afterRender=function(){return n.__super__.afterRender.apply(this,arguments),this.updateParticipants(this.summarized),this.$el.attr("data-id",this.model.id)},n.prototype.updateParticipants=function(e){var r;return r=e?this.$summarized:this.$full,this.$participants.text(r.text()),this.$toggle.text(e?t.t("more_participants","+%{total} more",{total:this.model.get("hiddenParticipantCount")}):t.t("hide","Hide"))},n.prototype.onToggle=function(t){return t.preventDefault(),this.updateParticipants(this.summarized=!this.summarized)},n.prototype.onReply=function(t){return t.preventDefault(),this.trigger("reply")},n.prototype.onReplyAll=function(t){return t.preventDefault(),this.trigger("reply-all")},n.prototype.onDelete=function(t){var e;return t.preventDefault(),confirm(this.messages.confirmDelete)?(e="/api/v1/conversations/"+this.model.get("conversation_id")+"/remove_messages",r.ajaxJSON(e,"POST",{remove:[this.model.id]}),this.remove()):void 0},n.prototype.onForward=function(t){return t.preventDefault(),this.trigger("forward")},n.prototype.onMenuOpen=function(t){return t.preventDefault()},n.prototype.onActionFocus=function(){return this.$metadata.addClass("hover")},n.prototype.onActionBlur=function(){return this.$metadata.removeClass("hover")},n}(s)})}).call(this);