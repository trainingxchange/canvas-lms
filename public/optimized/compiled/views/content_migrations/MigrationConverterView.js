(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var n in r)e.call(r,n)&&(t[n]=r[n]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};define(["jquery","underscore","jst/content_migrations/MigrationConverter","compiled/views/ValidatedFormView","i18n!content_migrations","vendor/jquery.ba-tinypubsub","jquery.disableWhileLoading"],function(e,o,n,i,s){var a,u;return a=function(i){function a(){return this.resetForm=t(this.resetForm,this),u=a.__super__.constructor.apply(this,arguments)}return r(a,i),a.optionProperty("selectOptions"),a.prototype.template=n,a.prototype.initialize=function(){return a.__super__.initialize.apply(this,arguments),e.subscribe("resetForm",this.resetForm)},a.prototype.els={"#converter":"$converter","#chooseMigrationConverter":"$chooseMigrationConverter","#submitMigration":"$submitBtn",".form-container":"$formActions"},a.prototype.events=o.extend({},a.prototype.events,{"change #chooseMigrationConverter":"selectConverter","click .cancelBtn":"resetForm"}),a.prototype.toJSON=function(t){return t=a.__super__.toJSON.apply(this,arguments),t.selectOptions=this.selectOptions||ENV.SELECT_OPTIONS,t},a.prototype.renderConverter=function(t){var e=this;return t?o.defer(function(){return e.$converter.html(t.render().$el),e.trigger("converterRendered")}):(this.resetForm(),this.trigger("converterReset"))},a.prototype.selectConverter=function(){return this.$formActions.show(),this.model.resetModel(),this.$chooseMigrationConverter.attr("aria-activedescendant",this.$chooseMigrationConverter.val()),this.model.set("migration_type",this.$chooseMigrationConverter.val()),e.publish("contentImportChange",{value:this.$chooseMigrationConverter.val(),migrationConverter:this})},a.prototype.submit=function(){var t,r,o=this;return t=this.$submitBtn.val(),this.$submitBtn.val(s.t("uploading","Uploading...")),e(window).on("beforeunload",function(){return s.t("upload_warning","Navigating away from this page will cancel the upload process.")}),r=a.__super__.submit.apply(this,arguments),null!=r?r.done(function(){return e(window).off("beforeunload"),o.$submitBtn.val(t),e.publish("migrationCreated",o.model.attributes),o.model.resetModel(),o.resetForm()}):void 0},a.prototype.resetForm=function(){return this.$formActions.hide(),this.$converter.empty(),this.$chooseMigrationConverter.val("none")},a}(i)})}).call(this);