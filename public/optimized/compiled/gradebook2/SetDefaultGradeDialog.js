(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=[].slice;define(["i18n!gradebook2","jquery","jst/SetDefaultGradeDialog","underscore","jquery.disableWhileLoading","jquery.instructure_forms","jqueryui/dialog","jquery.instructure_misc_plugins","vendor/jquery.ba-tinypubsub","compiled/jquery/fixDialogButtons","jst/_grading_box"],function(n,i,s,r){var u,o;return u=50,o=function(){function o(e){this.assignment=e.assignment,this.students=e.students,this.context_id=e.context_id,this.selected_section=e.selected_section,this.initDialog=t(this.initDialog,this),this.initDialog()}return o.prototype.initDialog=function(){var t,o,a,d,l,g=this;return l={assignment:this.assignment,showPointsPossible:(this.assignment.points_possible||"0"===this.assignment.points_possible)&&"gpa_scale"!==this.assignment.grading_type,url:"/courses/"+this.context_id+"/gradebook/update_submission",inputName:"default_grade"},l["assignment_grading_type_is_"+this.assignment.grading_type]=!0,this.$dialog=i(s(l)),this.$dialog.dialog({resizable:!1,width:350,open:function(){return g.$dialog.find(".grading_box").focus()},close:function(){return g.$dialog.remove()}}).fixDialogButtons(),t=this.$dialog,t.submit(function(s){var l,c,f,h,_;return s.preventDefault(),_=i.Deferred(),t.disableWhileLoading(_),l=t.getFormData(),h=a(),c=function(){var t;for(t=[];h.length;)t.push(h.splice(0,u));return t}(),f=c.map(function(e){var n,s;return s=o(e,l.default_grade),n=r.extend({},s,{dont_overwrite_grades:!l.overwrite_existing_grades}),i.ajaxJSON(t.attr("action"),"POST",n)}),i.when.apply(i,f).then(function(){var t,s;return t=1<=arguments.length?e.call(arguments,0):[],1===f.length&&(t=[t]),s=d(t),i.publish("submissions_updated",[s]),alert(n.t("alerts.scores_updated",{one:"1 Student score updated",other:"%{count} Student scores updated"},{count:s.length})),_.resolve(),g.$dialog.remove()})}),a=function(){return g.selected_section?r(g.students).filter(function(t){return r.include(t.sections,g.selected_section)}):r(g.students).values()},o=function(t,e){return r.chain(t).map(function(t){var n;return n="submissions[submission_"+t.id+"]",[[""+n+"[assignment_id]",g.assignment.id],[""+n+"[user_id]",t.id],[""+n+"[grade]",e]]}).flatten(!0).object().value()},d=function(t){return r.chain(t).map(function(t){var e,n,i;return e=t[0],i=t[1],[function(){var t,i,s;for(s=[],t=0,i=e.length;i>t;t++)n=e[t],s.push(n.submission);return s}()]}).flatten().value()}},o}()})}).call(this);